
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pandas入門 &#8212; 瀧川ゼミ計算社会科学ハンズオンセミナー2024第1回</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Pandas';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo2.png" class="logo__image only-light" alt="瀧川ゼミ計算社会科学ハンズオンセミナー2024第1回 - Home"/>
    <script>document.write(`<img src="_static/logo2.png" class="logo__image only-dark" alt="瀧川ゼミ計算社会科学ハンズオンセミナー2024第1回 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    pandas入門
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>pandas入門</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">pandasについて</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">データフレームの構造</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データの確認</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">データフレームの基本的操作</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">データ選択</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iloc-loc">iloc()とloc()</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">変数の追加、削除</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">変数の値のリコード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">変数のソート</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">問題1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">問題1-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">問題1-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">問題1-3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">問題1-4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query">フィルタリング1(queryメソッド)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">フィルタリング2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby">groupby（集団別操作）</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#applyagg">applyとagg</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">問題2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">問題2-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">問題2-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">問題2-3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">問題2-4:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">例題</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">問題2-5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">データフレームの作成、列名の変更</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">インデックスの設定と解除</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">データフレームの結合</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">データフレームの結合（続き）</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">問題3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">例題</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">問題3-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">問題3-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">問題3-3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotly">plotly入門</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">散布図</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">折れ線グラフ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">棒グラフ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy">tidyデータ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melt">meltによる変換</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#go">goオブジェクト</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">世界銀行の出生率データ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chetty-2022">Chetty(2022)のデータ</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">東京都の婚姻・離婚件数の時系列推移</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">問題</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">問題</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;google&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">cd</span> /content/drive/MyDrive/cssws2023
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/content/drive/MyDrive/cssws2023
</pre></div>
</div>
</div>
</div>
<section id="pandas">
<h1>pandas入門<a class="headerlink" href="#pandas" title="Link to this heading">#</a></h1>
<section id="id1">
<h2>pandasについて<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>pandasはRのデータフレームの思想を引き継いだデータ処理のためのモジュールです。</p></li>
<li><p>Rのデータフレームと同じく，データを表形式で操作できます。データ処理、分析のためには必須のモジュールといえます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span><span class="c1">#練習用のデータフレームを用いるためにplotyもimportします。</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h3>データフレームの構造<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>データフレームは次のようなindexとcolumnsをもつ構造となっています。</p></li>
</ul>
<img src="https://raw.githubusercontent.com/berutaki/github.io/main/2-0.png" width="500">
<ul class="simple">
<li><p>plotlyのサンプルtipsを実際に読み込んでみます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tips</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>列名は.columnsに格納されています。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>各列を一列として取り出すとシリーズというオブジェクトになります。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>シリーズはindexはもちますが、columnsはもちません。</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">total_bill</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      16.99
1      10.34
2      21.01
3      23.68
4      24.59
       ...  
239    29.03
240    27.18
241    22.67
242    17.82
243    18.78
Name: total_bill, Length: 244, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">total_bill</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RangeIndex(start=0, stop=244, step=1)
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>シリーズの中身の値をとり出したい場合は.valuesに格納されています。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,
        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,
        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,
        39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,
        52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,
        65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,
        78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,
        91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,
       104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116,
       117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129,
       130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142,
       143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155,
       156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168,
       169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181,
       182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194,
       195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207,
       208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220,
       221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233,
       234, 235, 236, 237, 238, 239, 240, 241, 242, 243])
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>データの確認<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>データの中身を確認するいくつかのメソッドを紹介します。</p></li>
<li><p>shapeには（行数,列数）がタプル型で格納されています。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(244, 7)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>describe()は要約統計量を出力します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-445a66b6-f995-4a36-a9a0-f54361b7628a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>244.000000</td>
      <td>244.000000</td>
      <td>244.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>19.785943</td>
      <td>2.998279</td>
      <td>2.569672</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.902412</td>
      <td>1.383638</td>
      <td>0.951100</td>
    </tr>
    <tr>
      <th>min</th>
      <td>3.070000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>13.347500</td>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>17.795000</td>
      <td>2.900000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>24.127500</td>
      <td>3.562500</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>50.810000</td>
      <td>10.000000</td>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-445a66b6-f995-4a36-a9a0-f54361b7628a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-445a66b6-f995-4a36-a9a0-f54361b7628a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-445a66b6-f995-4a36-a9a0-f54361b7628a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">total_bill</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    244.000000
mean      19.785943
std        8.902412
min        3.070000
25%       13.347500
50%       17.795000
75%       24.127500
max       50.810000
Name: total_bill, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>value_counts()はカテゴリ変数のカテゴリ数を数えます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Male      157
Female     87
Name: sex, dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>unique()はユニークな値を返します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Sun&#39;, &#39;Sat&#39;, &#39;Thur&#39;, &#39;Fri&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id4">
<h2>データフレームの基本的操作<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>データフレームの操作の基本は以下の5つにまとめることができます。</p>
<ol class="arabic simple">
<li><p>データ選択・条件によるフィルタリング</p></li>
<li><p>変数の追加・リコード</p></li>
<li><p>ソート</p></li>
<li><p>フィルタリング</p></li>
<li><p>groupby</p></li>
</ol>
</li>
</ul>
<section id="id5">
<h3>データ選択<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>列の選択はhoge.列名かhoge[‘列名’]で行います。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">total_bill</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      16.99
1      10.34
2      21.01
3      23.68
4      24.59
       ...  
239    29.03
240    27.18
241    22.67
242    17.82
243    18.78
Name: total_bill, Length: 244, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      16.99
1      10.34
2      21.01
3      23.68
4      24.59
       ...  
239    29.03
240    27.18
241    22.67
242    17.82
243    18.78
Name: total_bill, Length: 244, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>二列以上の選択は、リストを使って、hoge[[‘列名1’,’列名2’]]とします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span><span class="s1">&#39;tip&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-73d6e569-9afd-481f-8bad-0dc86f40ae86">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>239</th>
      <td>29.03</td>
      <td>5.92</td>
    </tr>
    <tr>
      <th>240</th>
      <td>27.18</td>
      <td>2.00</td>
    </tr>
    <tr>
      <th>241</th>
      <td>22.67</td>
      <td>2.00</td>
    </tr>
    <tr>
      <th>242</th>
      <td>17.82</td>
      <td>1.75</td>
    </tr>
    <tr>
      <th>243</th>
      <td>18.78</td>
      <td>3.00</td>
    </tr>
  </tbody>
</table>
<p>244 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-73d6e569-9afd-481f-8bad-0dc86f40ae86')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-73d6e569-9afd-481f-8bad-0dc86f40ae86 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-73d6e569-9afd-481f-8bad-0dc86f40ae86');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>行の選択はhoge[2:3]のように範囲で指定します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-caf936fe-3bca-468a-99a7-dd7f6550a791">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-caf936fe-3bca-468a-99a7-dd7f6550a791')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-caf936fe-3bca-468a-99a7-dd7f6550a791 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-caf936fe-3bca-468a-99a7-dd7f6550a791');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<div class="admonition error">
<p class="admonition-title">Error</p>
<ul class="simple">
<li><p>範囲を指定しないとエラーが出るので注意してください。例えば、1行目を取り出したいからとhoge[1]のようにするとエラーとなります。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/core/indexes/base.py:3802,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3801</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3802</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3803</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/_libs/index.pyx:138,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/_libs/index.pyx:165,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:5745,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:5753,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: 1

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">tips</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/core/frame.py:3807,</span> in <span class="ni">DataFrame.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">3805</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">nlevels</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_multilevel</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">3807</span> <span class="n">indexer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span> <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">indexer</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>     <span class="n">indexer</span> <span class="o">=</span> <span class="p">[</span><span class="n">indexer</span><span class="p">]</span>

<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/core/indexes/base.py:3804,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3802</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3803</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3804</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3805</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span>     <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3807</span>     <span class="c1">#  InvalidIndexError. Otherwise we fall through and re-raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span>     <span class="c1">#  the TypeError.</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_indexing_error</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: 1
</pre></div>
</div>
</div>
</div>
<section id="iloc-loc">
<h4>iloc()とloc()<a class="headerlink" href="#iloc-loc" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>選択には他に、iloc()とloc()という紛らわしいメソッドがあります。</p></li>
<li><p>まず.iloc()はindex（行）番号と列番号の両方を指定して選択します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#以後、iloc</span>
<span class="n">tips</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Male&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:,:</span><span class="mi">4</span><span class="p">]</span><span class="c1">#[2]行目以降、最初から[3]列目まで</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
    </tr>
    <tr>
      <th>5</th>
      <td>25.29</td>
      <td>4.71</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.77</td>
      <td>2.00</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>239</th>
      <td>29.03</td>
      <td>5.92</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>240</th>
      <td>27.18</td>
      <td>2.00</td>
      <td>Female</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>241</th>
      <td>22.67</td>
      <td>2.00</td>
      <td>Male</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>242</th>
      <td>17.82</td>
      <td>1.75</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>243</th>
      <td>18.78</td>
      <td>3.00</td>
      <td>Female</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
<p>242 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>239</th>
      <td>29.03</td>
      <td>5.92</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>240</th>
      <td>27.18</td>
      <td>2.00</td>
      <td>Female</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>241</th>
      <td>22.67</td>
      <td>2.00</td>
      <td>Male</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>242</th>
      <td>17.82</td>
      <td>1.75</td>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>243</th>
      <td>18.78</td>
      <td>3.00</td>
      <td>Female</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
<p>244 rows × 4 columns</p>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>indexの数字のみを指定すると、該当行がシリーズで取得されます。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total_bill     10.34
tip             1.66
sex             Male
smoker            No
day              Sun
time          Dinner
size               3
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>loc()はindex番号（or index名）と列名で選択。</p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<ul class="simple">
<li><p>つまりiloc()は列番号、loc()は列名で指定するという違いです。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#以後loc</span>
<span class="n">tips</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      Female
1        Male
2        Male
3        Male
4      Female
        ...  
239      Male
240    Female
241      Male
242      Male
243    Female
Name: sex, Length: 244, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">4</span><span class="p">,[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span><span class="s1">&#39;smoker&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f865c0d0-7847-4a40-8016-54d9d724b613">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sex</th>
      <th>smoker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Female</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Male</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Female</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f865c0d0-7847-4a40-8016-54d9d724b613')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f865c0d0-7847-4a40-8016-54d9d724b613 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f865c0d0-7847-4a40-8016-54d9d724b613');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>loc()の場合も同じく、indexの数字のみを指定すると、該当行がシリーズで取得されます。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total_bill     10.34
tip             1.66
sex             Male
smoker            No
day              Sun
time          Dinner
size               3
Name: 1, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h3>変数の追加、削除<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>変数の追加はdf[‘変数名’] = hogeとします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="c1">#testが追加されている</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4304fd43-f2e3-4e48-b528-3cf58e8eeee6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>test</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>test</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>test</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>test</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>test</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4304fd43-f2e3-4e48-b528-3cf58e8eeee6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4304fd43-f2e3-4e48-b528-3cf58e8eeee6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4304fd43-f2e3-4e48-b528-3cf58e8eeee6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>削除したい場合は、tips.drop(‘変数名’, axis = 1)とします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="c1">#axis = 1は列を指す，0は行。</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="c1">#testが削除されている</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-764da452-0665-4cd8-9b11-f5552e3c419a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-764da452-0665-4cd8-9b11-f5552e3c419a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-764da452-0665-4cd8-9b11-f5552e3c419a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-764da452-0665-4cd8-9b11-f5552e3c419a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
<section id="id7">
<h3>変数の値のリコード<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>リコードとは、変数の値のラベルを変えたり、カテゴリ化したりすることです。</p></li>
</ul>
<ul class="simple">
<li><p>カテゴリの値のラベルを変えるにはreplace()を使います。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Sun&#39;</span><span class="p">:</span><span class="s1">&#39;weekend&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">:</span><span class="s1">&#39;weekend&#39;</span><span class="p">,</span> <span class="s1">&#39;Thur&#39;</span><span class="p">:</span><span class="s1">&#39;weekday&#39;</span><span class="p">,</span><span class="s1">&#39;Fri&#39;</span><span class="p">:</span><span class="s1">&#39;weekday&#39;</span><span class="p">})</span><span class="c1">#replaceメソッドを使って、day列の値を置換しています。</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">weekend</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="c1">#weekendとweekdayの数を数える</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>weekend    163
weekday     81
Name: weekend, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>map()を使っても同じことができます。</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#mapメソッドを使って、day列の値を置換しています。</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;weekend&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="s1">&#39;Sun&#39;</span><span class="p">:</span><span class="s1">&#39;weekend&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">:</span><span class="s1">&#39;weekend&#39;</span><span class="p">,</span> <span class="s1">&#39;Thur&#39;</span><span class="p">:</span><span class="s1">&#39;weekday&#39;</span><span class="p">,</span><span class="s1">&#39;Fri&#39;</span><span class="p">:</span><span class="s1">&#39;weekday&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>連続変数のカテゴリ化にはcut()を使います。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0-10&#39;</span><span class="p">,</span><span class="s1">&#39;11-20&#39;</span><span class="p">,</span><span class="s1">&#39;21-30&#39;</span><span class="p">,</span><span class="s1">&#39;31-40&#39;</span><span class="p">,</span><span class="s1">&#39;41+&#39;</span><span class="p">]</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;bill_cat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">total_bill</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;bill_cat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11-20    130
21-30     65
31-40     22
0-10      17
41+       10
Name: bill_cat, dtype: int64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>apply()で列の各値に関数を適用できます。</p></li>
<li><p>例えば、float64となっているtip列の型変換をしたいとします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1.01
1      1.66
2      3.50
3      3.31
4      3.61
       ... 
239    5.92
240    2.00
241    2.00
242    1.75
243    3.00
Name: tip, Length: 244, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>apply()でround関数を適用します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span><span class="c1">#シリーズの個々の値に適用し、int64が返される。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1
1      2
2      4
3      3
4      4
      ..
239    6
240    2
241    2
242    2
243    3
Name: tip, Length: 244, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="p">)</span><span class="c1">#これでも動くが、シリーズの元のtypeが維持されてfloat64となる。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1.0
1      2.0
2      4.0
3      3.0
4      4.0
      ... 
239    6.0
240    2.0
241    2.0
242    2.0
243    3.0
Name: tip, Length: 244, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1
1      1
2      3
3      3
4      3
      ..
239    5
240    2
241    2
242    1
243    3
Name: tip, Length: 244, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="admonition error">
<p class="admonition-title">Error</p>
<ul class="simple">
<li><p>tips.tipはシリーズなので直接intなどとして型変換をすることはできません。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="p">)</span><span class="c1">#これはできない</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">int</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="p">)</span><span class="c1">#これはできない</span>

<span class="nn">File ~/.pyenv/versions/anaconda3-2022.10/envs/py39/lib/python3.9/site-packages/pandas/core/series.py:206,</span> in <span class="ni">_coerce_method.&lt;locals&gt;.wrapper</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span>     <span class="k">return</span> <span class="n">converter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="ne">--&gt; </span><span class="mi">206</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;cannot convert the series to </span><span class="si">{</span><span class="n">converter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="ne">TypeError</span>: cannot convert the series to &lt;class &#39;int&#39;&gt;
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>型変換についてはapply()ではなく、astype()というメソッドを用いても可能です。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="c1">#型変換のためのメソッドastype()がある。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1
1      1
2      3
3      3
4      3
      ..
239    5
240    2
241    2
242    1
243    3
Name: tip, Length: 244, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3>変数のソート<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>ソートにはsort_values()として引数にソートの基準としたい変数名を入れます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d76215e2-4c04-4aa8-8b90-549be9fc283c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>weekend</th>
      <th>bill_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>3.07</td>
      <td>1.00</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>1</td>
      <td>weekend</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>92</th>
      <td>5.75</td>
      <td>1.00</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Fri</td>
      <td>Dinner</td>
      <td>2</td>
      <td>weekday</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>111</th>
      <td>7.25</td>
      <td>1.00</td>
      <td>Female</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>1</td>
      <td>weekend</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>172</th>
      <td>7.25</td>
      <td>5.15</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>weekend</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>149</th>
      <td>7.51</td>
      <td>2.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>2</td>
      <td>weekday</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>182</th>
      <td>45.35</td>
      <td>3.50</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>156</th>
      <td>48.17</td>
      <td>5.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>6</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>59</th>
      <td>48.27</td>
      <td>6.73</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>212</th>
      <td>48.33</td>
      <td>9.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>170</th>
      <td>50.81</td>
      <td>10.00</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
  </tbody>
</table>
<p>244 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d76215e2-4c04-4aa8-8b90-549be9fc283c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d76215e2-4c04-4aa8-8b90-549be9fc283c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d76215e2-4c04-4aa8-8b90-549be9fc283c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>nlargest(10,”変数名”)とすると指定した変数のトップ10を抽出できる。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s2">&quot;total_bill&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-846ad9bd-b96f-4188-b4bc-2772d8839bd7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>weekend</th>
      <th>bill_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>170</th>
      <td>50.81</td>
      <td>10.00</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>212</th>
      <td>48.33</td>
      <td>9.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>59</th>
      <td>48.27</td>
      <td>6.73</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>156</th>
      <td>48.17</td>
      <td>5.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>6</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>182</th>
      <td>45.35</td>
      <td>3.50</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>102</th>
      <td>44.30</td>
      <td>2.50</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>197</th>
      <td>43.11</td>
      <td>5.00</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>4</td>
      <td>weekday</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>142</th>
      <td>41.19</td>
      <td>5.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>5</td>
      <td>weekday</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>184</th>
      <td>40.55</td>
      <td>3.00</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>95</th>
      <td>40.17</td>
      <td>4.73</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Fri</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekday</td>
      <td>41+</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-846ad9bd-b96f-4188-b4bc-2772d8839bd7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-846ad9bd-b96f-4188-b4bc-2772d8839bd7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-846ad9bd-b96f-4188-b4bc-2772d8839bd7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
<section id="id9">
<h3>問題1<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>gapminderデータセットを使ってデータ選択や変数のリコードの問題を解きます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">gapminder</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id10">
<h4>問題1-1<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>データフレームgapminderから、最初の5行を選択して表示してください。</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c298f80e-1e4f-4a20-b0b9-3c498e671849">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
      <th>iso_alpha</th>
      <th>iso_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c298f80e-1e4f-4a20-b0b9-3c498e671849')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c298f80e-1e4f-4a20-b0b9-3c498e671849 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c298f80e-1e4f-4a20-b0b9-3c498e671849');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>データフレームgapminderから、カラム ‘country’ と ‘continent’ のみを選択して表示してください。</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-5a5067d6-6216-4273-82f1-623f33692aae">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>continent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>Asia</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1699</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>1700</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>1701</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>1702</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
    </tr>
    <tr>
      <th>1703</th>
      <td>Zimbabwe</td>
      <td>Africa</td>
    </tr>
  </tbody>
</table>
<p>1704 rows × 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5a5067d6-6216-4273-82f1-623f33692aae')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5a5067d6-6216-4273-82f1-623f33692aae button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5a5067d6-6216-4273-82f1-623f33692aae');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>データフレームgapminderから、インデックス番号10から19までの行を選択して表示してください。</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b88f4bd4-4456-41ce-8a6d-95e6bacb5070">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
      <th>iso_alpha</th>
      <th>iso_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>2002</td>
      <td>42.129</td>
      <td>25268405</td>
      <td>726.734055</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>2007</td>
      <td>43.828</td>
      <td>31889923</td>
      <td>974.580338</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1952</td>
      <td>55.230</td>
      <td>1282697</td>
      <td>1601.056136</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1957</td>
      <td>59.280</td>
      <td>1476505</td>
      <td>1942.284244</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1962</td>
      <td>64.820</td>
      <td>1728137</td>
      <td>2312.888958</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1967</td>
      <td>66.220</td>
      <td>1984060</td>
      <td>2760.196931</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1972</td>
      <td>67.690</td>
      <td>2263554</td>
      <td>3313.422188</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1977</td>
      <td>68.930</td>
      <td>2509048</td>
      <td>3533.003910</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1982</td>
      <td>70.420</td>
      <td>2780097</td>
      <td>3630.880722</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Albania</td>
      <td>Europe</td>
      <td>1987</td>
      <td>72.000</td>
      <td>3075321</td>
      <td>3738.932735</td>
      <td>ALB</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-b88f4bd4-4456-41ce-8a6d-95e6bacb5070')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-b88f4bd4-4456-41ce-8a6d-95e6bacb5070 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-b88f4bd4-4456-41ce-8a6d-95e6bacb5070');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
<section id="id11">
<h4>問題1-2<a class="headerlink" href="#id11" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>データフレームgapminderの’country’カラム内の ‘United States’ を ‘USA’ に置き換えてください。</p>
<ul>
<li><p>“pd.options.display.max_rows = None”とすると全行表示可能</p></li>
</ul>
</li>
</ul>
<div class="cell tag_remove-input docutils container">
</div>
</section>
<section id="id12">
<h4>問題1-3<a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<p>データフレームgapminderの’pop’カラムを、以下のようなカテゴリに分割してください。</p>
<ul class="simple">
<li><p>‘Low’: 0-10,000,000</p></li>
<li><p>‘Medium’: 10,000,001-50,000,000</p></li>
<li><p>‘High’: 50,000,001 以上</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          country continent  year  lifeExp       pop   gdpPercap iso_alpha  \
0     Afghanistan      Asia  1952   28.801   8425333  779.445314       AFG   
1     Afghanistan      Asia  1957   30.332   9240934  820.853030       AFG   
2     Afghanistan      Asia  1962   31.997  10267083  853.100710       AFG   
3     Afghanistan      Asia  1967   34.020  11537966  836.197138       AFG   
4     Afghanistan      Asia  1972   36.088  13079460  739.981106       AFG   
...           ...       ...   ...      ...       ...         ...       ...   
1699     Zimbabwe    Africa  1987   62.351   9216418  706.157306       ZWE   
1700     Zimbabwe    Africa  1992   60.377  10704340  693.420786       ZWE   
1701     Zimbabwe    Africa  1997   46.809  11404948  792.449960       ZWE   
1702     Zimbabwe    Africa  2002   39.989  11926563  672.038623       ZWE   
1703     Zimbabwe    Africa  2007   43.487  12311143  469.709298       ZWE   

      iso_num pop_cat  
0           4     Low  
1           4     Low  
2           4  Medium  
3           4  Medium  
4           4  Medium  
...       ...     ...  
1699      716     Low  
1700      716  Medium  
1701      716  Medium  
1702      716  Medium  
1703      716  Medium  

[1704 rows x 9 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h4>問題1-4<a class="headerlink" href="#id13" title="Link to this heading">#</a></h4>
<p>データフレームgapminderの’pop’カラムを、人口が1000万人以上の国に対してはその値を2倍にし、それ以外の国に対してはそのままの値を持つ新しいカラムを作成してください。</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gapminder</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          country continent  year  lifeExp       pop   gdpPercap iso_alpha  \
0     Afghanistan      Asia  1952   28.801   8425333  779.445314       AFG   
1     Afghanistan      Asia  1957   30.332   9240934  820.853030       AFG   
2     Afghanistan      Asia  1962   31.997  10267083  853.100710       AFG   
3     Afghanistan      Asia  1967   34.020  11537966  836.197138       AFG   
4     Afghanistan      Asia  1972   36.088  13079460  739.981106       AFG   
...           ...       ...   ...      ...       ...         ...       ...   
1699     Zimbabwe    Africa  1987   62.351   9216418  706.157306       ZWE   
1700     Zimbabwe    Africa  1992   60.377  10704340  693.420786       ZWE   
1701     Zimbabwe    Africa  1997   46.809  11404948  792.449960       ZWE   
1702     Zimbabwe    Africa  2002   39.989  11926563  672.038623       ZWE   
1703     Zimbabwe    Africa  2007   43.487  12311143  469.709298       ZWE   

      iso_num pop_cat      pop2  
0           4     Low   8425333  
1           4     Low   9240934  
2           4  Medium  20534166  
3           4  Medium  23075932  
4           4  Medium  26158920  
...       ...     ...       ...  
1699      716     Low   9216418  
1700      716  Medium  21408680  
1701      716  Medium  22809896  
1702      716  Medium  23853126  
1703      716  Medium  24622286  

[1704 rows x 10 columns]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="query">
<h3>フィルタリング1(queryメソッド)<a class="headerlink" href="#query" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>.query(‘’)で’’の中に条件式を書くことで特定の条件を満たす行を抽出できます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tip &gt; 5&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     total_bill    tip     sex smoker   day    time  size
23        39.42   7.58    Male     No   Sat  Dinner     4
44        30.40   5.60    Male     No   Sun  Dinner     4
47        32.40   6.00    Male     No   Sun  Dinner     4
52        34.81   5.20  Female     No   Sun  Dinner     4
59        48.27   6.73    Male     No   Sat  Dinner     4
85        34.83   5.17  Female     No  Thur   Lunch     4
88        24.71   5.85    Male     No  Thur   Lunch     2
116       29.93   5.07    Male     No   Sun  Dinner     4
141       34.30   6.70    Male     No  Thur   Lunch     6
155       29.85   5.14  Female     No   Sun  Dinner     5
170       50.81  10.00    Male    Yes   Sat  Dinner     3
172        7.25   5.15    Male    Yes   Sun  Dinner     2
181       23.33   5.65    Male    Yes   Sun  Dinner     2
183       23.17   6.50    Male    Yes   Sun  Dinner     4
211       25.89   5.16    Male    Yes   Sat  Dinner     4
212       48.33   9.00    Male     No   Sat  Dinner     4
214       28.17   6.50  Female    Yes   Sat  Dinner     3
239       29.03   5.92    Male     No   Sat  Dinner     3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;tip &gt; 5 &amp; smoker ==&quot;No&quot;&#39;</span><span class="p">)</span><span class="c1">#文字列は&quot;&quot;で囲む</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e20858b6-a6ab-40bf-93e4-309fb9affe1c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>weekend</th>
      <th>bill_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>39.42</td>
      <td>7.58</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>44</th>
      <td>30.40</td>
      <td>5.60</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>47</th>
      <td>32.40</td>
      <td>6.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>52</th>
      <td>34.81</td>
      <td>5.20</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>59</th>
      <td>48.27</td>
      <td>6.73</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>85</th>
      <td>34.83</td>
      <td>5.17</td>
      <td>Female</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>4</td>
      <td>weekday</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>88</th>
      <td>24.71</td>
      <td>5.85</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>2</td>
      <td>weekday</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>116</th>
      <td>29.93</td>
      <td>5.07</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>141</th>
      <td>34.30</td>
      <td>6.70</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>6</td>
      <td>weekday</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>155</th>
      <td>29.85</td>
      <td>5.14</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>5</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>212</th>
      <td>48.33</td>
      <td>9.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>239</th>
      <td>29.03</td>
      <td>5.92</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-e20858b6-a6ab-40bf-93e4-309fb9affe1c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-e20858b6-a6ab-40bf-93e4-309fb9affe1c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-e20858b6-a6ab-40bf-93e4-309fb9affe1c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>文字列の条件はstr.hoge()を使います。</p>
<ul>
<li><p>例えば、contains()は指定した文字（部分文字列）を含む文字列の値をもつ行を抽出します。</p></li>
</ul>
</li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p>文字列の条件を使う場合は末尾に、engine = “python”とする必要があります。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;day.str.contains(&quot;S&quot;)&#39;</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span><span class="p">))</span><span class="c1">#contains()は指定した文字（部分文字列）を含む文字列の値をもつ行を抽出</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     total_bill   tip     sex smoker  day    time  size
0         16.99  1.01  Female     No  Sun  Dinner     2
1         10.34  1.66    Male     No  Sun  Dinner     3
2         21.01  3.50    Male     No  Sun  Dinner     3
3         23.68  3.31    Male     No  Sun  Dinner     2
4         24.59  3.61  Female     No  Sun  Dinner     4
..          ...   ...     ...    ...  ...     ...   ...
238       35.83  4.67  Female     No  Sat  Dinner     3
239       29.03  5.92    Male     No  Sat  Dinner     3
240       27.18  2.00  Female    Yes  Sat  Dinner     2
241       22.67  2.00    Male    Yes  Sat  Dinner     2
242       17.82  1.75    Male     No  Sat  Dinner     2

[163 rows x 7 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h3>フィルタリング2<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>query())を用いずにシリーズに条件式を適用し[]に入れる方法もあります。</p></li>
<li><p>例えば、tipが5より大きいという条件の場合、次のようにします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-dda9165b-5b15-45b0-851f-5e78280f191e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>weekend</th>
      <th>bill_cat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>39.42</td>
      <td>7.58</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>44</th>
      <td>30.40</td>
      <td>5.60</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>47</th>
      <td>32.40</td>
      <td>6.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>52</th>
      <td>34.81</td>
      <td>5.20</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>59</th>
      <td>48.27</td>
      <td>6.73</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>85</th>
      <td>34.83</td>
      <td>5.17</td>
      <td>Female</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>4</td>
      <td>weekday</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>88</th>
      <td>24.71</td>
      <td>5.85</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>2</td>
      <td>weekday</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>116</th>
      <td>29.93</td>
      <td>5.07</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>141</th>
      <td>34.30</td>
      <td>6.70</td>
      <td>Male</td>
      <td>No</td>
      <td>Thur</td>
      <td>Lunch</td>
      <td>6</td>
      <td>weekday</td>
      <td>31-40</td>
    </tr>
    <tr>
      <th>155</th>
      <td>29.85</td>
      <td>5.14</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>5</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>170</th>
      <td>50.81</td>
      <td>10.00</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>172</th>
      <td>7.25</td>
      <td>5.15</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>weekend</td>
      <td>0-10</td>
    </tr>
    <tr>
      <th>181</th>
      <td>23.33</td>
      <td>5.65</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>183</th>
      <td>23.17</td>
      <td>6.50</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>211</th>
      <td>25.89</td>
      <td>5.16</td>
      <td>Male</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>212</th>
      <td>48.33</td>
      <td>9.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>4</td>
      <td>weekend</td>
      <td>41+</td>
    </tr>
    <tr>
      <th>214</th>
      <td>28.17</td>
      <td>6.50</td>
      <td>Female</td>
      <td>Yes</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
    <tr>
      <th>239</th>
      <td>29.03</td>
      <td>5.92</td>
      <td>Male</td>
      <td>No</td>
      <td>Sat</td>
      <td>Dinner</td>
      <td>3</td>
      <td>weekend</td>
      <td>21-30</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dda9165b-5b15-45b0-851f-5e78280f191e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dda9165b-5b15-45b0-851f-5e78280f191e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dda9165b-5b15-45b0-851f-5e78280f191e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>何が起きているかを確認します。</p>
<ul>
<li><p>ここでは条件式がTrue, Falseを出力し、それが[]に入ることでデータが抽出される仕組みとなっています。</p></li>
</ul>
</li>
</ul>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span> <span class="o">&gt;</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      False
1      False
2      False
3      False
4      False
5      False
6      False
7      False
8      False
9      False
10     False
11     False
12     False
13     False
14     False
15     False
16     False
17     False
18     False
19     False
20     False
21     False
22     False
23      True
24     False
25     False
26     False
27     False
28     False
29     False
30     False
31     False
32     False
33     False
34     False
35     False
36     False
37     False
38     False
39     False
40     False
41     False
42     False
43     False
44      True
45     False
46     False
47      True
48     False
49     False
50     False
51     False
52      True
53     False
54     False
55     False
56     False
57     False
58     False
59      True
60     False
61     False
62     False
63     False
64     False
65     False
66     False
67     False
68     False
69     False
70     False
71     False
72     False
73     False
74     False
75     False
76     False
77     False
78     False
79     False
80     False
81     False
82     False
83     False
84     False
85      True
86     False
87     False
88      True
89     False
90     False
91     False
92     False
93     False
94     False
95     False
96     False
97     False
98     False
99     False
100    False
101    False
102    False
103    False
104    False
105    False
106    False
107    False
108    False
109    False
110    False
111    False
112    False
113    False
114    False
115    False
116     True
117    False
118    False
119    False
120    False
121    False
122    False
123    False
124    False
125    False
126    False
127    False
128    False
129    False
130    False
131    False
132    False
133    False
134    False
135    False
136    False
137    False
138    False
139    False
140    False
141     True
142    False
143    False
144    False
145    False
146    False
147    False
148    False
149    False
150    False
151    False
152    False
153    False
154    False
155     True
156    False
157    False
158    False
159    False
160    False
161    False
162    False
163    False
164    False
165    False
166    False
167    False
168    False
169    False
170     True
171    False
172     True
173    False
174    False
175    False
176    False
177    False
178    False
179    False
180    False
181     True
182    False
183     True
184    False
185    False
186    False
187    False
188    False
189    False
190    False
191    False
192    False
193    False
194    False
195    False
196    False
197    False
198    False
199    False
200    False
201    False
202    False
203    False
204    False
205    False
206    False
207    False
208    False
209    False
210    False
211     True
212     True
213    False
214     True
215    False
216    False
217    False
218    False
219    False
220    False
221    False
222    False
223    False
224    False
225    False
226    False
227    False
228    False
229    False
230    False
231    False
232    False
233    False
234    False
235    False
236    False
237    False
238    False
239     True
240    False
241    False
242    False
243    False
Name: tip, dtype: bool
</pre></div>
</div>
</div>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>条件をつなげるときには、and条件の場合、()&amp;()、or条件の場合()|()と書きます。”and”や”or”ではないので注意しましょう。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tips</span><span class="p">[(</span><span class="n">tips</span><span class="o">.</span><span class="n">tip</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">smoker</span> <span class="o">==</span> <span class="s1">&#39;No&#39;</span><span class="p">)])</span><span class="c1">#()がないとエラー#&amp;でないとエラー</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     total_bill   tip     sex smoker   day    time  size
0         16.99  1.01  Female     No   Sun  Dinner     2
1         10.34  1.66    Male     No   Sun  Dinner     3
2         21.01  3.50    Male     No   Sun  Dinner     3
3         23.68  3.31    Male     No   Sun  Dinner     2
4         24.59  3.61  Female     No   Sun  Dinner     4
..          ...   ...     ...    ...   ...     ...   ...
235       10.07  1.25    Male     No   Sat  Dinner     2
238       35.83  4.67  Female     No   Sat  Dinner     3
239       29.03  5.92    Male     No   Sat  Dinner     3
242       17.82  1.75    Male     No   Sat  Dinner     2
243       18.78  3.00  Female     No  Thur  Dinner     2

[157 rows x 7 columns]
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>[]で条件を与える場合、query()と異なり、str.hoge()を使うときにengine = “python”と書く必要ありません。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="n">tips</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     total_bill   tip     sex smoker  day    time  size
0         16.99  1.01  Female     No  Sun  Dinner     2
1         10.34  1.66    Male     No  Sun  Dinner     3
2         21.01  3.50    Male     No  Sun  Dinner     3
3         23.68  3.31    Male     No  Sun  Dinner     2
4         24.59  3.61  Female     No  Sun  Dinner     4
..          ...   ...     ...    ...  ...     ...   ...
238       35.83  4.67  Female     No  Sat  Dinner     3
239       29.03  5.92    Male     No  Sat  Dinner     3
240       27.18  2.00  Female    Yes  Sat  Dinner     2
241       22.67  2.00    Male    Yes  Sat  Dinner     2
242       17.82  1.75    Male     No  Sat  Dinner     2

[163 rows x 7 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="groupby">
<h3>groupby（集団別操作）<a class="headerlink" href="#groupby" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>カテゴリごとの集計や平均などを出力したいときはgroupbyを用います。</p></li>
<li><p>groupby(‘cat’)[‘hoge’].mean()などとすると、catカテゴリの各メンバーのhoge変数の平均が出力されます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="c1">#groupbyメソッドを使って、sex列でグループ化し、tip列の平均値を求めています。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sex
Female    2.833448
Male      3.089618
Name: tip, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[</span><span class="s1">&#39;smoker&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="c1">#groupbyメソッドを使って、sex列でグループ化し、smoker列の値の数を求めています。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sex
Female     87
Male      157
Name: smoker, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="c1">#groupbyメソッドを使って、day列でグループ化し、describeメソッドを使って統計量を求めています。</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1c19525c-59c4-4139-a8bb-34c22d4f925d">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="8" halign="left">total_bill</th>
      <th colspan="5" halign="left">tip</th>
      <th colspan="8" halign="left">size</th>
    </tr>
    <tr>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>...</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>day</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fri</th>
      <td>19.0</td>
      <td>17.151579</td>
      <td>8.302660</td>
      <td>5.75</td>
      <td>12.0950</td>
      <td>15.38</td>
      <td>21.7500</td>
      <td>40.17</td>
      <td>19.0</td>
      <td>2.734737</td>
      <td>...</td>
      <td>3.3650</td>
      <td>4.73</td>
      <td>19.0</td>
      <td>2.105263</td>
      <td>0.567131</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Sat</th>
      <td>87.0</td>
      <td>20.441379</td>
      <td>9.480419</td>
      <td>3.07</td>
      <td>13.9050</td>
      <td>18.24</td>
      <td>24.7400</td>
      <td>50.81</td>
      <td>87.0</td>
      <td>2.993103</td>
      <td>...</td>
      <td>3.3700</td>
      <td>10.00</td>
      <td>87.0</td>
      <td>2.517241</td>
      <td>0.819275</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Sun</th>
      <td>76.0</td>
      <td>21.410000</td>
      <td>8.832122</td>
      <td>7.25</td>
      <td>14.9875</td>
      <td>19.63</td>
      <td>25.5975</td>
      <td>48.17</td>
      <td>76.0</td>
      <td>3.255132</td>
      <td>...</td>
      <td>4.0000</td>
      <td>6.50</td>
      <td>76.0</td>
      <td>2.842105</td>
      <td>1.007341</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>Thur</th>
      <td>62.0</td>
      <td>17.682742</td>
      <td>7.886170</td>
      <td>7.51</td>
      <td>12.4425</td>
      <td>16.20</td>
      <td>20.1550</td>
      <td>43.11</td>
      <td>62.0</td>
      <td>2.771452</td>
      <td>...</td>
      <td>3.3625</td>
      <td>6.70</td>
      <td>62.0</td>
      <td>2.451613</td>
      <td>1.066285</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 24 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-1c19525c-59c4-4139-a8bb-34c22d4f925d')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-1c19525c-59c4-4139-a8bb-34c22d4f925d button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-1c19525c-59c4-4139-a8bb-34c22d4f925d');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<section id="applyagg">
<h4>applyとagg<a class="headerlink" href="#applyagg" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>自作関数を適用する場合はapply()を用います。</p></li>
<li><p>例えば、不偏分散を計算する自作関数を作って適用したい場合は以下のようにします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">unbiased_variance</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
   <span class="n">y</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">y</span>
<span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)[</span><span class="s2">&quot;total_bill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">unbiased_variance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>day
Fri     68.934158
Sat     89.878338
Sun     78.006376
Thur    62.191683
Name: total_bill, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>agg()で変数ごとに異なる関数を適用することもできます。agg(“var1”:”hoge1”,”var2”:”hoge2”)と書きます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;total_bill&quot;</span><span class="p">:</span><span class="n">unbiased_variance</span><span class="p">,</span><span class="s2">&quot;tip&quot;</span><span class="p">:</span><span class="s2">&quot;mean&quot;</span><span class="p">})</span><span class="c1">#備え付けの関数は&quot;&quot;で囲む</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f2579fb9-c7ee-4fe9-90b9-d2f5da948434">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
    </tr>
    <tr>
      <th>day</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fri</th>
      <td>68.934158</td>
      <td>2.734737</td>
    </tr>
    <tr>
      <th>Sat</th>
      <td>89.878338</td>
      <td>2.993103</td>
    </tr>
    <tr>
      <th>Sun</th>
      <td>78.006376</td>
      <td>3.255132</td>
    </tr>
    <tr>
      <th>Thur</th>
      <td>62.191683</td>
      <td>2.771452</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f2579fb9-c7ee-4fe9-90b9-d2f5da948434')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f2579fb9-c7ee-4fe9-90b9-d2f5da948434 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f2579fb9-c7ee-4fe9-90b9-d2f5da948434');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
</section>
<section id="id15">
<h3>問題2<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>引き続き、gapminderデータセットを使ってデータフレームの操作の練習をする。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">gapminder</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id16">
<h4>問題2-1<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<p>データセットの国別の平均GDP（gdpPercap）を求めてください。</p>
<div class="cell tag_remove-input tag_hide-output docutils container">
<details class="hide above-output">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell outputs</span>
<span class="expanded">Hide code cell outputs</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country
Afghanistan                   802.674598
Albania                      3255.366633
Algeria                      4426.025973
Angola                       3607.100529
Argentina                    8955.553783
Australia                   19980.595634
Austria                     20411.916279
Bahrain                     18077.663945
Bangladesh                    817.558818
Belgium                     19900.758072
Benin                        1155.395107
Bolivia                      2961.228754
Bosnia and Herzegovina       3484.779069
Botswana                     5031.503557
Brazil                       5829.316653
Bulgaria                     6384.055172
Burkina Faso                  843.990665
Burundi                       471.662990
Cambodia                      675.367824
Cameroon                     1774.634222
Canada                      22410.746340
Central African Republic      958.784697
Chad                         1165.453674
Chile                        6703.289147
China                        1488.307694
Colombia                     4195.342920
Comoros                      1314.380339
Congo, Dem. Rep.              648.342646
Congo, Rep.                  3312.788215
Costa Rica                   5448.610779
Cote d&#39;Ivoire                1912.825382
Croatia                      9331.712346
Cuba                         6283.258678
Czech Republic              13920.011379
Denmark                     21671.824888
Djibouti                     2697.833162
Dominican Republic           2844.856405
Ecuador                      5733.624767
Egypt                        3074.030731
El Salvador                  4431.846597
Equatorial Guinea            2469.166681
Eritrea                       541.002507
Ethiopia                      509.115156
Finland                     17473.722667
France                      18833.570327
Gabon                       11529.865474
Gambia                        680.132586
Germany                     20556.684433
Ghana                        1044.582046
Greece                      13969.036833
Guatemala                    4015.402771
Guinea                        776.067305
Guinea-Bissau                 652.157208
Haiti                        1620.739290
Honduras                     2834.413083
Hong Kong, China            16228.700865
Hungary                     10888.175654
Iceland                     20531.422272
India                        1057.296307
Indonesia                    1741.365360
Iran                         7376.582905
Iraq                         7811.809117
Ireland                     15758.606238
Israel                      14160.936434
Italy                       16245.209006
Jamaica                      6197.645405
Japan                       17750.869984
Jordan                       3128.120762
Kenya                        1200.415720
Korea, Dem. Rep.             2591.852578
Korea, Rep.                  8217.318485
Kuwait                      65332.910472
Lebanon                      7269.216241
Lesotho                       780.553393
Liberia                       604.814141
Libya                       12013.579201
Madagascar                   1335.595027
Malawi                        575.447212
Malaysia                     5406.038197
Mali                          673.093069
Mauritania                   1356.671011
Mauritius                    4768.942221
Mexico                       7724.112675
Mongolia                     1692.804612
Montenegro                   7208.064560
Morocco                      2447.908864
Mozambique                    542.278332
Myanmar                       439.333333
Namibia                      3675.582087
Nepal                         782.728822
Netherlands                 21748.852208
New Zealand                 17262.622813
Nicaragua                    3424.655770
Niger                         781.076798
Nigeria                      1488.309429
Norway                      26747.306554
Oman                        12138.562227
Pakistan                     1439.270689
Panama                       5754.827172
Paraguay                     3239.606791
Peru                         5613.844087
Philippines                  2174.771130
Poland                       8416.553912
Portugal                    11354.091927
Puerto Rico                 10863.164303
Reunion                      4898.398390
Romania                      7300.169974
Rwanda                        675.669043
Sao Tome and Principe        1382.782001
Saudi Arabia                20261.743635
Senegal                      1533.121694
Serbia                       9305.049444
Sierra Leone                 1072.819493
Singapore                   17425.382267
Slovak Republic             10415.530689
Slovenia                    14074.582109
Somalia                      1140.793252
South Africa                 7247.431074
Spain                       14029.826479
Sri Lanka                    1854.731119
Sudan                        1835.010430
Swaziland                    3163.352358
Sweden                      19943.126104
Switzerland                 27074.334405
Syria                        3009.287981
Taiwan                      10224.807181
Tanzania                      849.281271
Thailand                     3045.966474
Togo                         1153.820116
Trinidad and Tobago          7866.871946
Tunisia                      3477.210351
Turkey                       4469.453380
Uganda                        810.383788
United Kingdom              19380.472986
United States               26261.151347
Uruguay                      7100.133176
Venezuela                   10088.516252
Vietnam                      1017.712615
West Bank and Gaza           3759.996781
Yemen, Rep.                  1569.274672
Zambia                       1358.199409
Zimbabwe                      635.858042
Name: gdpPercap, dtype: float64
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="id17">
<h4>問題2-2<a class="headerlink" href="#id17" title="Link to this heading">#</a></h4>
<p>データセットから2007年のデータだけを抽出し、人口（pop）が上位10位の国をリストアップしてください。</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>299             China
707             India
1619    United States
719         Indonesia
179            Brazil
1175         Pakistan
107        Bangladesh
1139          Nigeria
803             Japan
995            Mexico
Name: country, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="id18">
<h4>問題2-3<a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<p>データセットから、アジア（continentが’Asia’）の国のデータを抽出し、GDP（gdpPercap）が上位5位の国を2007年のデータに基づいてリストアップしてください。</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>863               Kuwait
1367           Singapore
671     Hong Kong, China
803                Japan
95               Bahrain
Name: country, dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="id19">
<h4>問題2-4:<a class="headerlink" href="#id19" title="Link to this heading">#</a></h4>
<p>データフレームgapminderを、’continent’ごとにグループ化し、各大陸の平均寿命（’lifeExp’）の最大値と最小値を求めてください。</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>max, minという関数が使えます。</p></li>
</ul>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a9603e74-082c-49f7-9d97-7898a1c8b60e">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>max</th>
      <th>min</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>76.442</td>
      <td>23.599</td>
    </tr>
    <tr>
      <th>Americas</th>
      <td>80.653</td>
      <td>37.579</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>82.603</td>
      <td>28.801</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>81.757</td>
      <td>43.585</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>81.235</td>
      <td>69.120</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-a9603e74-082c-49f7-9d97-7898a1c8b60e')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-a9603e74-082c-49f7-9d97-7898a1c8b60e button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-a9603e74-082c-49f7-9d97-7898a1c8b60e');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
</section>
<section id="id20">
<h4>例題<a class="headerlink" href="#id20" title="Link to this heading">#</a></h4>
<p>データフレームgapminderを、’year’ごとにグループ化し、各年の人口（’pop’）が最も高い上位3つの国名（’country’）を求めてください。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">top_5_countries_by_pop</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="n">top_5_countries</span> <span class="o">=</span> <span class="n">group</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">)[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">top_5_countries</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">top_5_countries_by_year</span> <span class="o">=</span> <span class="n">gapminder</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">top_5_countries_by_pop</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">top_5_countries_by_year</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>year
1952     [China, India, United States, Japan, Indonesia]
1957     [China, India, United States, Japan, Indonesia]
1962     [China, India, United States, Indonesia, Japan]
1967     [China, India, United States, Indonesia, Japan]
1972     [China, India, United States, Indonesia, Japan]
1977    [China, India, United States, Indonesia, Brazil]
1982    [China, India, United States, Indonesia, Brazil]
1987    [China, India, United States, Indonesia, Brazil]
1992    [China, India, United States, Indonesia, Brazil]
1997    [China, India, United States, Indonesia, Brazil]
2002    [China, India, United States, Indonesia, Brazil]
2007    [China, India, United States, Indonesia, Brazil]
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="id21">
<h4>問題2-5<a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<p>データフレームgapminderを、’continent’ごとにグループ化し、各大陸のGDP（’gdpPercap’）が平均以上の国名（’country’）を求めてください。</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>continent  year
Africa     1952    [Algeria, Angola, Congo, Rep., Cote d&#39;Ivoire, ...
           1957    [Algeria, Angola, Congo, Rep., Cote d&#39;Ivoire, ...
           1962    [Algeria, Angola, Congo, Rep., Cote d&#39;Ivoire, ...
           1967    [Algeria, Angola, Congo, Rep., Cote d&#39;Ivoire, ...
           1972    [Algeria, Angola, Congo, Rep., Cote d&#39;Ivoire, ...
           1977    [Algeria, Angola, Botswana, Congo, Rep., Djibo...
           1982    [Algeria, Angola, Botswana, Congo, Rep., Cote ...
           1987    [Algeria, Angola, Botswana, Cameroon, Congo, R...
           1992    [Algeria, Angola, Botswana, Congo, Rep., Djibo...
           1997    [Algeria, Botswana, Congo, Rep., Egypt, Equato...
           2002    [Algeria, Angola, Botswana, Congo, Rep., Egypt...
           2007    [Algeria, Angola, Botswana, Congo, Rep., Egypt...
Americas   1952    [Argentina, Canada, Cuba, United States, Urugu...
           1957    [Argentina, Canada, Cuba, Jamaica, United Stat...
           1962    [Argentina, Canada, Cuba, Jamaica, Peru, Puert...
           1967    [Argentina, Canada, Cuba, Jamaica, Mexico, Per...
           1972    [Argentina, Canada, Jamaica, Mexico, Puerto Ri...
           1977    [Argentina, Canada, Mexico, Puerto Rico, Trini...
           1982    [Argentina, Canada, Mexico, Puerto Rico, Trini...
           1987    [Argentina, Brazil, Canada, Mexico, Puerto Ric...
           1992    [Argentina, Canada, Mexico, Puerto Rico, Unite...
           1997    [Argentina, Canada, Chile, Mexico, Puerto Rico...
           2002    [Canada, Chile, Mexico, Puerto Rico, Trinidad ...
           2007    [Argentina, Canada, Chile, Mexico, Puerto Rico...
Asia       1952                      [Bahrain, Kuwait, Saudi Arabia]
           1957       [Bahrain, Iraq, Kuwait, Lebanon, Saudi Arabia]
           1962    [Bahrain, Iraq, Israel, Japan, Kuwait, Saudi A...
           1967    [Bahrain, Hong Kong, China, Iraq, Israel, Japa...
           1972    [Bahrain, Hong Kong, China, Iran, Iraq, Israel...
           1977    [Bahrain, Hong Kong, China, Iran, Iraq, Israel...
           1982    [Bahrain, Hong Kong, China, Iran, Iraq, Israel...
           1987    [Bahrain, Hong Kong, China, Iraq, Israel, Japa...
           1992    [Bahrain, Hong Kong, China, Israel, Japan, Kor...
           1997    [Bahrain, Hong Kong, China, Israel, Japan, Kor...
           2002    [Bahrain, Hong Kong, China, Israel, Japan, Kor...
           2007    [Bahrain, Hong Kong, China, Israel, Japan, Kor...
Europe     1952    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1957    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1962    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1967    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1972    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1977    [Austria, Belgium, Czech Republic, Denmark, Fi...
           1982    [Austria, Belgium, Denmark, Finland, France, G...
           1987    [Austria, Belgium, Denmark, Finland, France, G...
           1992    [Austria, Belgium, Denmark, Finland, France, G...
           1997    [Austria, Belgium, Denmark, Finland, France, G...
           2002    [Austria, Belgium, Denmark, Finland, France, G...
           2007    [Austria, Belgium, Denmark, Finland, France, G...
Oceania    1952                                        [New Zealand]
           1957                                        [New Zealand]
           1962                                        [New Zealand]
           1967                                          [Australia]
           1972                                          [Australia]
           1977                                          [Australia]
           1982                                          [Australia]
           1987                                          [Australia]
           1992                                          [Australia]
           1997                                          [Australia]
           2002                                          [Australia]
           2007                                          [Australia]
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id22">
<h3>データフレームの作成、列名の変更<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>データフレームの作成については、ディクショナリを使う方法と2次元リストから作る方法を紹介します。</p></li>
</ul>
<ul class="simple">
<li><p>ディクショナリから作る場合、valueはリストとします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:[</span><span class="s1">&#39;マックス&#39;</span><span class="p">,</span> <span class="s1">&#39;エミール&#39;</span><span class="p">,</span> <span class="s1">&#39;ゲオルグ&#39;</span><span class="p">,</span> <span class="s1">&#39;タルコット&#39;</span><span class="p">,</span> <span class="s1">&#39;ロバート&#39;</span><span class="p">],</span> <span class="s1">&#39;birthyear&#39;</span><span class="p">:[</span><span class="s1">&#39;1864&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">,</span><span class="s1">&#39;1902&#39;</span><span class="p">,</span><span class="s1">&#39;1910&#39;</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>リストから作る場合、2次元のリストを元とします。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;マックス&#39;</span><span class="p">,</span><span class="s1">&#39;1864&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;エミール&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;ゲオルグ&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;タルコット&#39;</span><span class="p">,</span><span class="s1">&#39;1902&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;ロバート&#39;</span><span class="p">,</span><span class="s1">&#39;1910&#39;</span><span class="p">]</span>
         <span class="p">]</span><span class="c1">#リストのリストを作って…</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;birthyear&#39;</span><span class="p">])</span><span class="c1">#columnsで列名を指定してデータフレームを作成</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>列名の変更はcolumnsに直接代入するか、renameを用います。</p></li>
<li><p>例として次の列名をcolumnsに直接代入してみます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;名前&#39;</span><span class="p">,</span><span class="s1">&#39;誕生年&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>名前</th>
      <th>誕生年</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>-　いったんもとにもどして。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;birthyear&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>B</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>C</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>D</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>E</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>renameを使うと特定の列の名前だけを変更できます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;名前&#39;</span><span class="p">})</span><span class="c1">#renameメソッドを使って列名を変更</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>名前</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>B</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>C</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>D</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>E</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id23">
<h3>インデックスの設定と解除<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>df.indexに直接代入してインデックス名の変更ができます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>B</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>C</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>D</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>E</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>set_index()を使うと、既存の列名をインデックスに使えます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>birthyear</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>マックス</th>
      <td>1864</td>
    </tr>
    <tr>
      <th>エミール</th>
      <td>1858</td>
    </tr>
    <tr>
      <th>ゲオルグ</th>
      <td>1858</td>
    </tr>
    <tr>
      <th>タルコット</th>
      <td>1902</td>
    </tr>
    <tr>
      <th>ロバート</th>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>reset_index()使うと、indexが数字になり、元のインデックス名は列変数になります。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id24">
<h3>データフレームの結合<a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>２つの異なるデータフレームを結合する方法をみてみます。</p></li>
<li><p>まず、2つデータフレームを用意します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;マックス&#39;</span><span class="p">,</span> <span class="s1">&#39;エミール&#39;</span><span class="p">,</span> <span class="s1">&#39;ゲオルグ&#39;</span><span class="p">,</span> <span class="s1">&#39;タルコット&#39;</span><span class="p">,</span> <span class="s1">&#39;ロバート&#39;</span><span class="p">]</span>
<span class="n">birthyear</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1864&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">,</span><span class="s1">&#39;1858&#39;</span><span class="p">,</span><span class="s1">&#39;1902&#39;</span><span class="p">,</span><span class="s1">&#39;1910&#39;</span><span class="p">]</span>
<span class="n">last_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ウェーバー&#39;</span><span class="p">,</span><span class="s1">&#39;デュルケム&#39;</span><span class="p">,</span><span class="s1">&#39;ジンメル&#39;</span><span class="p">,</span><span class="s1">&#39;パーソンズ&#39;</span><span class="p">,</span><span class="s1">&#39;マートン&#39;</span><span class="p">]</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;birthyear&#39;</span><span class="p">:</span><span class="n">birthyear</span><span class="p">})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">:</span><span class="n">last_name</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d1b92491-8cd0-4d62-830c-ceb3f1119e2c">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-d1b92491-8cd0-4d62-830c-ceb3f1119e2c')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-d1b92491-8cd0-4d62-830c-ceb3f1119e2c button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-d1b92491-8cd0-4d62-830c-ceb3f1119e2c');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c15adda2-8b76-41a1-9ee3-e31525ebf34b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>ウェーバー</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>デュルケム</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>ジンメル</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>パーソンズ</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>マートン</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c15adda2-8b76-41a1-9ee3-e31525ebf34b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c15adda2-8b76-41a1-9ee3-e31525ebf34b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c15adda2-8b76-41a1-9ee3-e31525ebf34b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>横に結語するには、pd.merge()として、結合したいデータフレームを引数に与え、’on’にkeyとして使う列名を指定します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-96314bc2-0fb1-4495-8767-4b89ac8de664">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
      <td>ウェーバー</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
      <td>デュルケム</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
      <td>ジンメル</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
      <td>パーソンズ</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
      <td>マートン</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-96314bc2-0fb1-4495-8767-4b89ac8de664')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-96314bc2-0fb1-4495-8767-4b89ac8de664 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-96314bc2-0fb1-4495-8767-4b89ac8de664');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="c1">#こっちでも可</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f0f823c1-4549-489d-a6dc-a8a5c1ad57c8">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
      <th>last_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>マックス</td>
      <td>1864</td>
      <td>ウェーバー</td>
    </tr>
    <tr>
      <th>1</th>
      <td>エミール</td>
      <td>1858</td>
      <td>デュルケム</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ゲオルグ</td>
      <td>1858</td>
      <td>ジンメル</td>
    </tr>
    <tr>
      <th>3</th>
      <td>タルコット</td>
      <td>1902</td>
      <td>パーソンズ</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ロバート</td>
      <td>1910</td>
      <td>マートン</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f0f823c1-4549-489d-a6dc-a8a5c1ad57c8')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f0f823c1-4549-489d-a6dc-a8a5c1ad57c8 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f0f823c1-4549-489d-a6dc-a8a5c1ad57c8');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  </div></div>
</div>
<ul class="simple">
<li><p>縦に結合するには、concat()を使いますが、まず練習用の別のデータフレームを作ります。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:[</span><span class="s1">&#39;ガブリエル&#39;</span><span class="p">],</span><span class="s1">&#39;birthyear&#39;</span><span class="p">:[</span><span class="s1">&#39;1843&#39;</span><span class="p">]})</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>birthyear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ガブリエル</td>
      <td>1843</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>concat()で結合します。引数はリスト([])となるので注意してください。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">53</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span><span class="n">df3</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;df1&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id25">
<h2>データフレームの結合（続き）<a class="headerlink" href="#id25" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>キー（onに用いる変数）の値の集合が一致しないデータフレームを結合する場合、結合の仕方をいくつか指定する必要があります。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">],</span>
         <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">]}</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">,</span> <span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Grace&#39;</span><span class="p">],</span>
         <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">]}</span>


<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alice</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Charlie</td>
      <td>35</td>
    </tr>
    <tr>
      <th>3</th>
      <td>David</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Eve</td>
      <td>45</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Charlie</td>
      <td>50000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>David</td>
      <td>60000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Eve</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Frank</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Grace</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>内部結合（inner join）:</p>
<ul>
<li><p>内部結合は、2つのデータフレームに共通のキーを持つ行だけを結果のデータフレームに含めます。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Name  Age  Salary
0  Charlie   35   50000
1    David   40   60000
2      Eve   45   70000
</pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>merge()のデフォルトで何も指定しないと内部結合となります。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Name  Age  Salary
0  Charlie   35   50000
1    David   40   60000
2      Eve   45   70000
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>外部結合（outer join）:</p>
<ul>
<li><p>外部結合は、2つのデータフレームのすべての行を結果のデータフレームに含めます。</p></li>
<li><p>キーが一致しない場合、キーの存在しない方のデータフレームの列変数の値は欠損となるため、欠損値（NaN）が結果のデータフレームに挿入されます。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Name   Age   Salary
0    Alice  25.0      NaN
1      Bob  30.0      NaN
2  Charlie  35.0  50000.0
3    David  40.0  60000.0
4      Eve  45.0  70000.0
5    Frank   NaN  80000.0
6    Grace   NaN  90000.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>左のデータフレームのキーに限ってすべて含める場合はleft join,右の場合はright joinといいます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Name  Age   Salary
0    Alice   25      NaN
1      Bob   30      NaN
2  Charlie   35  50000.0
3    David   40  60000.0
4      Eve   45  70000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Name   Age  Salary
0  Charlie  35.0   50000
1    David  40.0   60000
2      Eve  45.0   70000
3    Frank   NaN   80000
4    Grace   NaN   90000
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>結合後に名前の重複したコラムには接尾辞suffixesが自動で付与されます。</p></li>
</ul>
</div>
<ul class="simple">
<li><p>以下は、Nameという列名が重複する二つのデータフレームです。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
         <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">],</span>
         <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">45</span><span class="p">]}</span>

<span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
         <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Charlie&#39;</span><span class="p">,</span> <span class="s1">&#39;David&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">,</span> <span class="s1">&#39;Frank&#39;</span><span class="p">,</span> <span class="s1">&#39;Grace&#39;</span><span class="p">],</span>
         <span class="s1">&#39;Salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">60000</span><span class="p">,</span> <span class="mi">70000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">]}</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>結語すると、_x, _yのようなSuffixesがつきます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ID   Name_x  Age   Name_y  Salary
0   3  Charlie   35  Charlie   50000
1   4    David   40    David   60000
2   5      Eve   45      Eve   70000
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>suffixes = ()で変更もできます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span><span class="s1">&#39;_right&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_df1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ID Name_left  Age Name_right  Salary
0   3   Charlie   35    Charlie   50000
1   4     David   40      David   60000
2   5       Eve   45        Eve   70000
</pre></div>
</div>
</div>
</div>
</section>
<section id="id26">
<h2>問題3<a class="headerlink" href="#id26" title="Link to this heading">#</a></h2>
<section id="id27">
<h3>例題<a class="headerlink" href="#id27" title="Link to this heading">#</a></h3>
<p>gapminderデータセットから2002年と2007年のデータを抽出し、その期間でGDP（gdpPercap）が最も大きく増加した上位5位の国をリストアップしてください。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder_2002</span> <span class="o">=</span> <span class="n">gapminder</span><span class="p">[</span><span class="n">gapminder</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2002</span><span class="p">]</span>
<span class="n">gapminder_2007</span> <span class="o">=</span> <span class="n">gapminder</span><span class="p">[</span><span class="n">gapminder</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2007</span><span class="p">]</span>

<span class="n">gdp_growth</span> <span class="o">=</span> <span class="n">gapminder_2007</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">gapminder_2002</span><span class="p">[[</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;gdpPercap&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_2007&#39;</span><span class="p">,</span> <span class="s1">&#39;_2002&#39;</span><span class="p">))</span>
<span class="n">gdp_growth</span><span class="p">[</span><span class="s1">&#39;gdp_increase&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_growth</span><span class="p">[</span><span class="s1">&#39;gdpPercap_2007&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">gdp_growth</span><span class="p">[</span><span class="s1">&#39;gdpPercap_2002&#39;</span><span class="p">]</span>
<span class="n">top_5_gdp_increase_countries</span> <span class="o">=</span> <span class="n">gdp_growth</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;gdp_increase&#39;</span><span class="p">)[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">top_5_gdp_increase_countries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Kuwait&#39;, &#39;Singapore&#39;, &#39;Hong Kong, China&#39;, &#39;Ireland&#39;, &#39;Trinidad and Tobago&#39;]
</pre></div>
</div>
</div>
</div>
<section id="id28">
<h4>問題3-1<a class="headerlink" href="#id28" title="Link to this heading">#</a></h4>
<p>2007年のデータと、2002年のデータを抽出し、それぞれについて人口（pop）の上位10カ国を特定してください。次に、mergeを使用して、これらの2つの上位10カ国リストを比較し、両方のリストに含まれる国のデータを抽出してください。</p>
</section>
<section id="id29">
<h4>問題3-2<a class="headerlink" href="#id29" title="Link to this heading">#</a></h4>
<p>2007年のデータから、各大陸のGDP（gdpPercap）の平均を計算し、新しいデータフレームに格納してください。同様に、2002年のデータから各大陸のGDPの平均を計算し、別の新しいデータフレームに格納してください。merge関数を使用して、これら2つのデータフレームを結合し、各大陸の2002年と2007年のGDP平均の比較が可能な新しいデータフレームを作成してください。</p>
</section>
<section id="id30">
<h4>問題3-3<a class="headerlink" href="#id30" title="Link to this heading">#</a></h4>
<p>gapminderデータセットから2002年と2007年のデータを抽出し、その期間でGDP（gdpPercap）が最も大きく増加した上位5位の国をリストアップしてください。</p>
</section>
</section>
</section>
<section id="plotly">
<h2>plotly入門<a class="headerlink" href="#plotly" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>この授業ではplotyを可視化ツールとして使います。</p></li>
<li><p>簡易版のplotly.expressについて簡単に概説します。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.18.2.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.io</span> <span class="k">as</span> <span class="nn">pio</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Bar</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">pio</span><span class="o">.</span><span class="n">write_image</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;fig.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tips</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id31">
<h3>散布図<a class="headerlink" href="#id31" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>散布図はpx.scatterで描けます。</p></li>
<li><p>書式は、データフレームとx軸、y軸を指定するのが基本です。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;tip&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>                            <div id="a439cab6-9740-4e41-9bb3-5f27e359046f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a439cab6-9740-4e41-9bb3-5f27e359046f")) {                    Plotly.newPlot(                        "a439cab6-9740-4e41-9bb3-5f27e359046f",                        [{"hovertemplate":"total_bill=%{x}<br>tip=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[16.99,10.34,21.01,23.68,24.59,25.29,8.77,26.88,15.04,14.78,10.27,35.26,15.42,18.43,14.83,21.58,10.33,16.29,16.97,20.65,17.92,20.29,15.77,39.42,19.82,17.81,13.37,12.69,21.7,19.65,9.55,18.35,15.06,20.69,17.78,24.06,16.31,16.93,18.69,31.27,16.04,17.46,13.94,9.68,30.4,18.29,22.23,32.4,28.55,18.04,12.54,10.29,34.81,9.94,25.56,19.49,38.01,26.41,11.24,48.27,20.29,13.81,11.02,18.29,17.59,20.08,16.45,3.07,20.23,15.01,12.02,17.07,26.86,25.28,14.73,10.51,17.92,27.2,22.76,17.29,19.44,16.66,10.07,32.68,15.98,34.83,13.03,18.28,24.71,21.16,28.97,22.49,5.75,16.32,22.75,40.17,27.28,12.03,21.01,12.46,11.35,15.38,44.3,22.42,20.92,15.36,20.49,25.21,18.24,14.31,14.0,7.25,38.07,23.95,25.71,17.31,29.93,10.65,12.43,24.08,11.69,13.42,14.26,15.95,12.48,29.8,8.52,14.52,11.38,22.82,19.08,20.27,11.17,12.26,18.26,8.51,10.33,14.15,16.0,13.16,17.47,34.3,41.19,27.05,16.43,8.35,18.64,11.87,9.78,7.51,14.07,13.13,17.26,24.55,19.77,29.85,48.17,25.0,13.39,16.49,21.5,12.66,16.21,13.81,17.51,24.52,20.76,31.71,10.59,10.63,50.81,15.81,7.25,31.85,16.82,32.9,17.89,14.48,9.6,34.63,34.65,23.33,45.35,23.17,40.55,20.69,20.9,30.46,18.15,23.1,15.69,19.81,28.44,15.48,16.58,7.56,10.34,43.11,13.0,13.51,18.71,12.74,13.0,16.4,20.53,16.47,26.59,38.73,24.27,12.76,30.06,25.89,48.33,13.27,28.17,12.9,28.15,11.59,7.74,30.14,12.16,13.42,8.58,15.98,13.42,16.27,10.09,20.45,13.28,22.12,24.01,15.69,11.61,10.77,15.53,10.07,12.6,32.83,35.83,29.03,27.18,22.67,17.82,18.78],"xaxis":"x","y":[1.01,1.66,3.5,3.31,3.61,4.71,2.0,3.12,1.96,3.23,1.71,5.0,1.57,3.0,3.02,3.92,1.67,3.71,3.5,3.35,4.08,2.75,2.23,7.58,3.18,2.34,2.0,2.0,4.3,3.0,1.45,2.5,3.0,2.45,3.27,3.6,2.0,3.07,2.31,5.0,2.24,2.54,3.06,1.32,5.6,3.0,5.0,6.0,2.05,3.0,2.5,2.6,5.2,1.56,4.34,3.51,3.0,1.5,1.76,6.73,3.21,2.0,1.98,3.76,2.64,3.15,2.47,1.0,2.01,2.09,1.97,3.0,3.14,5.0,2.2,1.25,3.08,4.0,3.0,2.71,3.0,3.4,1.83,5.0,2.03,5.17,2.0,4.0,5.85,3.0,3.0,3.5,1.0,4.3,3.25,4.73,4.0,1.5,3.0,1.5,2.5,3.0,2.5,3.48,4.08,1.64,4.06,4.29,3.76,4.0,3.0,1.0,4.0,2.55,4.0,3.5,5.07,1.5,1.8,2.92,2.31,1.68,2.5,2.0,2.52,4.2,1.48,2.0,2.0,2.18,1.5,2.83,1.5,2.0,3.25,1.25,2.0,2.0,2.0,2.75,3.5,6.7,5.0,5.0,2.3,1.5,1.36,1.63,1.73,2.0,2.5,2.0,2.74,2.0,2.0,5.14,5.0,3.75,2.61,2.0,3.5,2.5,2.0,2.0,3.0,3.48,2.24,4.5,1.61,2.0,10.0,3.16,5.15,3.18,4.0,3.11,2.0,2.0,4.0,3.55,3.68,5.65,3.5,6.5,3.0,5.0,3.5,2.0,3.5,4.0,1.5,4.19,2.56,2.02,4.0,1.44,2.0,5.0,2.0,2.0,4.0,2.01,2.0,2.5,4.0,3.23,3.41,3.0,2.03,2.23,2.0,5.16,9.0,2.5,6.5,1.1,3.0,1.5,1.44,3.09,2.2,3.48,1.92,3.0,1.58,2.5,2.0,3.0,2.72,2.88,2.0,3.0,3.39,1.47,3.0,1.25,1.0,1.17,4.67,5.92,2.0,2.0,1.75,3.0],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"total_bill"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"tip"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a439cab6-9740-4e41-9bb3-5f27e359046f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div></div></div>
</div>
<ul class="simple">
<li><p>color=’size’などと指定すると客のサイズごとのデータ点を区別できます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;tip&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p>ファセットも簡単にできます。男女別にプロットを分けてみます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;tip&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">facet_col</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="id32">
<h3>折れ線グラフ<a class="headerlink" href="#id32" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>px.lineを用います。</p></li>
<li><p>アジアに限定して折れ線グラフを書いてみます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">gapminder</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder_Asia</span> <span class="o">=</span> <span class="n">gapminder</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;continent==&quot;Asia&quot;&#39;</span><span class="p">)</span>
<span class="n">gapminder_Asia</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
      <th>iso_alpha</th>
      <th>iso_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
      <td>AFG</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">gapminder_Asia</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p>plotlyの最大の特徴はインタラクティブな操作ができることです。例えば、KuwaitのGDPが大きすぎるので、legendでKuwaitをクリックして、これを消すことができます。</p></li>
</ul>
</div>
</section>
<section id="id33">
<h3>棒グラフ<a class="headerlink" href="#id33" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>棒グラフで日本と台湾のGDPの推移を見ます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder_Japan_Taiwan</span> <span class="o">=</span> <span class="n">gapminder</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country==&quot;Japan&quot;|country==&quot;Taiwan&quot;&#39;</span><span class="p">)</span>
<span class="n">gapminder_Japan_Taiwan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
      <th>iso_alpha</th>
      <th>iso_num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>792</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>63.030</td>
      <td>86459025</td>
      <td>3216.956347</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>793</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>65.500</td>
      <td>91563009</td>
      <td>4317.694365</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>794</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>68.730</td>
      <td>95831757</td>
      <td>6576.649461</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>795</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>71.430</td>
      <td>100825279</td>
      <td>9847.788607</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>796</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>73.420</td>
      <td>107188273</td>
      <td>14778.786360</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>797</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1977</td>
      <td>75.380</td>
      <td>113872473</td>
      <td>16610.377010</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>798</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1982</td>
      <td>77.110</td>
      <td>118454974</td>
      <td>19384.105710</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>799</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1987</td>
      <td>78.670</td>
      <td>122091325</td>
      <td>22375.941890</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>800</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1992</td>
      <td>79.360</td>
      <td>124329269</td>
      <td>26824.895110</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>801</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>1997</td>
      <td>80.690</td>
      <td>125956499</td>
      <td>28816.584990</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>802</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>2002</td>
      <td>82.000</td>
      <td>127065841</td>
      <td>28604.591900</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>803</th>
      <td>Japan</td>
      <td>Asia</td>
      <td>2007</td>
      <td>82.603</td>
      <td>127467972</td>
      <td>31656.068060</td>
      <td>JPN</td>
      <td>392</td>
    </tr>
    <tr>
      <th>1500</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>58.500</td>
      <td>8550362</td>
      <td>1206.947913</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1501</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>62.400</td>
      <td>10164215</td>
      <td>1507.861290</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1502</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>65.200</td>
      <td>11918938</td>
      <td>1822.879028</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1503</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>67.500</td>
      <td>13648692</td>
      <td>2643.858681</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1504</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>69.390</td>
      <td>15226039</td>
      <td>4062.523897</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1505</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1977</td>
      <td>70.590</td>
      <td>16785196</td>
      <td>5596.519826</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1506</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1982</td>
      <td>72.160</td>
      <td>18501390</td>
      <td>7426.354774</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1507</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1987</td>
      <td>73.400</td>
      <td>19757799</td>
      <td>11054.561750</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1508</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1992</td>
      <td>74.260</td>
      <td>20686918</td>
      <td>15215.657900</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1509</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>1997</td>
      <td>75.250</td>
      <td>21628605</td>
      <td>20206.820980</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1510</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>2002</td>
      <td>76.990</td>
      <td>22454239</td>
      <td>23235.423290</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
    <tr>
      <th>1511</th>
      <td>Taiwan</td>
      <td>Asia</td>
      <td>2007</td>
      <td>78.400</td>
      <td>23174294</td>
      <td>28718.276840</td>
      <td>TWN</td>
      <td>158</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>barmode=”group”とすると列でグループ化した棒グラフを描画できます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">gapminder_Japan_Taiwan</span> <span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p>barmode=”overlay”とすると重なり合った棒グラフを描画できます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">gapminder_Japan_Taiwan</span> <span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s2">&quot;overlay&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="tidy">
<h3>tidyデータ<a class="headerlink" href="#tidy" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>ハドリー・ウィッカムは、整然(tidy)データの条件として以下の4つを挙げています（https://ja.wikipedia.org/wiki/Tidy_data）。</p>
<ul>
<li><p>個々の変数 (variable) が1つの列 (column) をなす。</p></li>
<li><p>個々の観測 (observation) が1つの行 (row) をなす。</p></li>
<li><p>個々の観測の構成単位の類型 (type of observational unit) が1つの表 (table) をなす。</p></li>
<li><p>個々の値 (value) が1つのセル (cell) をなす
<img src="https://raw.githubusercontent.com/berutaki/github.io/main/2-2.png" width="500"></p></li>
</ul>
</li>
<li><p>応用ではデータをプロットするときにtidy形式にすると便利になります。</p></li>
</ul>
</section>
<section id="melt">
<h3>meltによる変換<a class="headerlink" href="#melt" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>tidyデータを作るためにはどうすればよいでしょうか。</p></li>
<li><p>pandasではwideからlongへの変換に概ね相当します。</p></li>
<li><p>meltはデータフレームの横に並んでいる列変数を，一つの変数の値として縦に持つように変換します。</p></li>
<li><p>melt(id_vars = ‘year’, var_name = ‘var’, value_name = ‘value’)のように書く。</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p>変換しない変数はid.varとして指定する。</p>
<ul>
<li><p>var_nameが元の列変数を値として持つ変換後の変数名</p></li>
<li><p>value_nameは元の値を縦に値として持つ変数名</p></li>
</ul>
</li>
</ul>
</div>
<img src="https://raw.githubusercontent.com/berutaki/github.io/main/2-1.png" width="500">
<ul class="simple">
<li><p>tidy形式にすることで変数の値による曲線の使い分けなどができるようになります。</p></li>
<li><p>例えば、’lifeExp’,’gdpPercap’が同じグラフで比較したいとき。</p></li>
<li><p>このwideデータを変換して…</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">gapminder</span><span class="p">()</span>
<span class="n">gapminder_Japan</span> <span class="o">=</span> <span class="n">gapminder</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;country==&quot;Japan&quot;&#39;</span><span class="p">)[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;lifeExp&#39;</span><span class="p">,</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">]]</span>
<span class="n">gapminder_Japan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>792</th>
      <td>1952</td>
      <td>63.030</td>
      <td>3216.956347</td>
    </tr>
    <tr>
      <th>793</th>
      <td>1957</td>
      <td>65.500</td>
      <td>4317.694365</td>
    </tr>
    <tr>
      <th>794</th>
      <td>1962</td>
      <td>68.730</td>
      <td>6576.649461</td>
    </tr>
    <tr>
      <th>795</th>
      <td>1967</td>
      <td>71.430</td>
      <td>9847.788607</td>
    </tr>
    <tr>
      <th>796</th>
      <td>1972</td>
      <td>73.420</td>
      <td>14778.786360</td>
    </tr>
    <tr>
      <th>797</th>
      <td>1977</td>
      <td>75.380</td>
      <td>16610.377010</td>
    </tr>
    <tr>
      <th>798</th>
      <td>1982</td>
      <td>77.110</td>
      <td>19384.105710</td>
    </tr>
    <tr>
      <th>799</th>
      <td>1987</td>
      <td>78.670</td>
      <td>22375.941890</td>
    </tr>
    <tr>
      <th>800</th>
      <td>1992</td>
      <td>79.360</td>
      <td>26824.895110</td>
    </tr>
    <tr>
      <th>801</th>
      <td>1997</td>
      <td>80.690</td>
      <td>28816.584990</td>
    </tr>
    <tr>
      <th>802</th>
      <td>2002</td>
      <td>82.000</td>
      <td>28604.591900</td>
    </tr>
    <tr>
      <th>803</th>
      <td>2007</td>
      <td>82.603</td>
      <td>31656.068060</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>longにします。</p>
<ul>
<li><p>ここで’var’の値として、’lifeExp’,’gdpPercap’をもたせます。</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder_Japan_long</span> <span class="o">=</span> <span class="n">gapminder_Japan</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">gapminder_Japan_long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>var</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1952</td>
      <td>lifeExp</td>
      <td>63.030000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1957</td>
      <td>lifeExp</td>
      <td>65.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>lifeExp</td>
      <td>68.730000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1967</td>
      <td>lifeExp</td>
      <td>71.430000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1972</td>
      <td>lifeExp</td>
      <td>73.420000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1977</td>
      <td>lifeExp</td>
      <td>75.380000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1982</td>
      <td>lifeExp</td>
      <td>77.110000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1987</td>
      <td>lifeExp</td>
      <td>78.670000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1992</td>
      <td>lifeExp</td>
      <td>79.360000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1997</td>
      <td>lifeExp</td>
      <td>80.690000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2002</td>
      <td>lifeExp</td>
      <td>82.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2007</td>
      <td>lifeExp</td>
      <td>82.603000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1952</td>
      <td>gdpPercap</td>
      <td>3216.956347</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1957</td>
      <td>gdpPercap</td>
      <td>4317.694365</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1962</td>
      <td>gdpPercap</td>
      <td>6576.649461</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1967</td>
      <td>gdpPercap</td>
      <td>9847.788607</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1972</td>
      <td>gdpPercap</td>
      <td>14778.786360</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1977</td>
      <td>gdpPercap</td>
      <td>16610.377010</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1982</td>
      <td>gdpPercap</td>
      <td>19384.105710</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1987</td>
      <td>gdpPercap</td>
      <td>22375.941890</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1992</td>
      <td>gdpPercap</td>
      <td>26824.895110</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1997</td>
      <td>gdpPercap</td>
      <td>28816.584990</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2002</td>
      <td>gdpPercap</td>
      <td>28604.591900</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2007</td>
      <td>gdpPercap</td>
      <td>31656.068060</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>colorで’var’と指定すれば、’lifeExp’と’gdpPercap’を色分けできます。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span> <span class="n">gapminder_Japan_long</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">)</span><span class="c1">#よいプロットではない</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="go">
<h3>goオブジェクト<a class="headerlink" href="#go" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>より高度な作図はgoオブジェクトを使います。</p></li>
<li><p>ここでは一枚のプロットに異なるY軸目盛りを表示する方法を紹介する。</p>
<ol class="arabic simple">
<li><p>go.Figure()でプロットの「白紙」を作る。</p></li>
<li><p>add_trace()で一つずつ散布図を重ねていく。</p></li>
<li><p>2つ目のY軸のデータには、yaxis=”y2”を指定して、2つ目のY軸に関連付ける。</p></li>
<li><p>update_layout()で二つのY軸の設定をする。</p></li>
<li><p>fig.show()で表示する。</p></li>
</ol>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># プロットの作成</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Y1軸のデータ</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;lifeExp&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;lifeExp&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">))</span>


<span class="c1"># Y2軸のデータ</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines+markers&quot;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="s2">&quot;y2&quot;</span><span class="p">))</span>

<span class="c1"># Y軸の設定</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&#39;lifeExp&quot;</span><span class="p">,</span>
        <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">),</span>
        <span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">yaxis2</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;gdpPercap&quot;</span><span class="p">,</span>
        <span class="n">titlefont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span>
        <span class="n">tickfont</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">),</span>
        <span class="n">anchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">overlaying</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
        <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul class="simple">
<li><p>pxのfacet_colなら異なるY軸を表示できるが煩雑になる。</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span> <span class="n">gapminder_Japan_long</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">facet_col</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">)</span>
<span class="c1"># 各サブプロットのY軸の範囲を設定</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">matches</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">update_yaxis_range</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;lifeExp&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;lifeExp&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">5</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">500</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">gapminder_Japan</span><span class="p">[</span><span class="s1">&#39;gdpPercap&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">500</span><span class="p">]</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">axis</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">select_yaxes</span><span class="p">()):</span>
    <span class="n">update_yaxis_range</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="id34">
<h3>世界銀行の出生率データ<a class="headerlink" href="#id34" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>生データの処理の実例を見てみます。
https://data.worldbank.org/indicator/SP.DYN.TFRT.IN</p></li>
<li><p>世界銀行の出生率データを可視化してみます。</p></li>
<li><p>生データの処理はいろいろ面倒です。</p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>-　csvの値の中に’,’が入っているのでpandasでは読み込めない。csvモジュールを使う。</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/berutaki/github.io/main/fertility_rate.csv&quot;</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="c1"># CSVファイルを正しく区切る</span>
<span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">]</span>

<span class="c1"># データフレームに変換する</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">:],</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="c1">#最初の4行は捨てる</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>年が横に入っているので、longに変換したい。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>Indicator Name</th>
      <th>Indicator Code</th>
      <th>1960</th>
      <th>1961</th>
      <th>1962</th>
      <th>1963</th>
      <th>1964</th>
      <th>1965</th>
      <th>...</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>2020</th>
      <th>2021</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aruba</td>
      <td>ABW</td>
      <td>Fertility rate, total (births per woman)</td>
      <td>SP.DYN.TFRT.IN</td>
      <td>4.82</td>
      <td>4.655</td>
      <td>4.471</td>
      <td>4.271</td>
      <td>4.059</td>
      <td>3.842</td>
      <td>...</td>
      <td>2.117</td>
      <td>2.148</td>
      <td>1.972</td>
      <td>1.953</td>
      <td>1.839</td>
      <td>1.587</td>
      <td>1.486</td>
      <td>1.325</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>Africa Eastern and Southern</td>
      <td>AFE</td>
      <td>Fertility rate, total (births per woman)</td>
      <td>SP.DYN.TFRT.IN</td>
      <td>6.72412501084242</td>
      <td>6.74275210020318</td>
      <td>6.76293005566599</td>
      <td>6.77871194340642</td>
      <td>6.78842004142392</td>
      <td>6.80032228007056</td>
      <td>...</td>
      <td>4.80882146896218</td>
      <td>4.7398628747128</td>
      <td>4.67761935515813</td>
      <td>4.61567138298739</td>
      <td>4.57041032724911</td>
      <td>4.52770656918433</td>
      <td>4.48289939808498</td>
      <td>4.41690156838726</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>Fertility rate, total (births per woman)</td>
      <td>SP.DYN.TFRT.IN</td>
      <td>7.282</td>
      <td>7.284</td>
      <td>7.292</td>
      <td>7.302</td>
      <td>7.304</td>
      <td>7.305</td>
      <td>...</td>
      <td>5.696</td>
      <td>5.56</td>
      <td>5.405</td>
      <td>5.262</td>
      <td>5.129</td>
      <td>5.002</td>
      <td>4.87</td>
      <td>4.75</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa Western and Central</td>
      <td>AFW</td>
      <td>Fertility rate, total (births per woman)</td>
      <td>SP.DYN.TFRT.IN</td>
      <td>6.45844789624312</td>
      <td>6.47151755185967</td>
      <td>6.49182578734167</td>
      <td>6.50608758636194</td>
      <td>6.52535544956749</td>
      <td>6.54110170802647</td>
      <td>...</td>
      <td>5.50634979270689</td>
      <td>5.43749340764512</td>
      <td>5.38505930791309</td>
      <td>5.32870923111315</td>
      <td>5.2553453710546</td>
      <td>5.18631941888717</td>
      <td>5.11893203861357</td>
      <td>5.0493293781153</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>Angola</td>
      <td>AGO</td>
      <td>Fertility rate, total (births per woman)</td>
      <td>SP.DYN.TFRT.IN</td>
      <td>6.708</td>
      <td>6.79</td>
      <td>6.872</td>
      <td>6.954</td>
      <td>7.036</td>
      <td>7.116</td>
      <td>...</td>
      <td>5.953</td>
      <td>5.864</td>
      <td>5.774</td>
      <td>5.686</td>
      <td>5.6</td>
      <td>5.519</td>
      <td>5.442</td>
      <td>5.371</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>5 rows × 67 columns</p>
</div></div></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<ul class="simple">
<li><p>“Country Name”変数名にスペースが入っている</p></li>
</ul>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Country Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Aruba&#39;, &#39;Africa Eastern and Southern&#39;, &#39;Afghanistan&#39;,
       &#39;Africa Western and Central&#39;, &#39;Angola&#39;, &#39;Albania&#39;, &#39;Andorra&#39;,
       &#39;Arab World&#39;, &#39;United Arab Emirates&#39;, &#39;Argentina&#39;, &#39;Armenia&#39;,
       &#39;American Samoa&#39;, &#39;Antigua and Barbuda&#39;, &#39;Australia&#39;, &#39;Austria&#39;,
       &#39;Azerbaijan&#39;, &#39;Burundi&#39;, &#39;Belgium&#39;, &#39;Benin&#39;, &#39;Burkina Faso&#39;,
       &#39;Bangladesh&#39;, &#39;Bulgaria&#39;, &#39;Bahrain&#39;, &#39;Bahamas, The&#39;,
       &#39;Bosnia and Herzegovina&#39;, &#39;Belarus&#39;, &#39;Belize&#39;, &#39;Bermuda&#39;,
       &#39;Bolivia&#39;, &#39;Brazil&#39;, &#39;Barbados&#39;, &#39;Brunei Darussalam&#39;, &#39;Bhutan&#39;,
       &#39;Botswana&#39;, &#39;Central African Republic&#39;, &#39;Canada&#39;,
       &#39;Central Europe and the Baltics&#39;, &#39;Switzerland&#39;, &#39;Channel Islands&#39;,
       &#39;Chile&#39;, &#39;China&#39;, &quot;Cote d&#39;Ivoire&quot;, &#39;Cameroon&#39;, &#39;Congo, Dem. Rep.&#39;,
       &#39;Congo, Rep.&#39;, &#39;Colombia&#39;, &#39;Comoros&#39;, &#39;Cabo Verde&#39;, &#39;Costa Rica&#39;,
       &#39;Caribbean small states&#39;, &#39;Cuba&#39;, &#39;Curacao&#39;, &#39;Cayman Islands&#39;,
       &#39;Cyprus&#39;, &#39;Czechia&#39;, &#39;Germany&#39;, &#39;Djibouti&#39;, &#39;Dominica&#39;, &#39;Denmark&#39;,
       &#39;Dominican Republic&#39;, &#39;Algeria&#39;,
       &#39;East Asia &amp; Pacific (excluding high income)&#39;,
       &#39;Early-demographic dividend&#39;, &#39;East Asia &amp; Pacific&#39;,
       &#39;Europe &amp; Central Asia (excluding high income)&#39;,
       &#39;Europe &amp; Central Asia&#39;, &#39;Ecuador&#39;, &#39;Egypt, Arab Rep.&#39;,
       &#39;Euro area&#39;, &#39;Eritrea&#39;, &#39;Spain&#39;, &#39;Estonia&#39;, &#39;Ethiopia&#39;,
       &#39;European Union&#39;, &#39;Fragile and conflict affected situations&#39;,
       &#39;Finland&#39;, &#39;Fiji&#39;, &#39;France&#39;, &#39;Faroe Islands&#39;,
       &#39;Micronesia, Fed. Sts.&#39;, &#39;Gabon&#39;, &#39;United Kingdom&#39;, &#39;Georgia&#39;,
       &#39;Ghana&#39;, &#39;Gibraltar&#39;, &#39;Guinea&#39;, &#39;Gambia, The&#39;, &#39;Guinea-Bissau&#39;,
       &#39;Equatorial Guinea&#39;, &#39;Greece&#39;, &#39;Grenada&#39;, &#39;Greenland&#39;, &#39;Guatemala&#39;,
       &#39;Guam&#39;, &#39;Guyana&#39;, &#39;High income&#39;, &#39;Hong Kong SAR, China&#39;,
       &#39;Honduras&#39;, &#39;Heavily indebted poor countries (HIPC)&#39;, &#39;Croatia&#39;,
       &#39;Haiti&#39;, &#39;Hungary&#39;, &#39;IBRD only&#39;, &#39;IDA &amp; IBRD total&#39;, &#39;IDA total&#39;,
       &#39;IDA blend&#39;, &#39;Indonesia&#39;, &#39;IDA only&#39;, &#39;Isle of Man&#39;, &#39;India&#39;,
       &#39;Not classified&#39;, &#39;Ireland&#39;, &#39;Iran, Islamic Rep.&#39;, &#39;Iraq&#39;,
       &#39;Iceland&#39;, &#39;Israel&#39;, &#39;Italy&#39;, &#39;Jamaica&#39;, &#39;Jordan&#39;, &#39;Japan&#39;,
       &#39;Kazakhstan&#39;, &#39;Kenya&#39;, &#39;Kyrgyz Republic&#39;, &#39;Cambodia&#39;, &#39;Kiribati&#39;,
       &#39;St. Kitts and Nevis&#39;, &#39;Korea, Rep.&#39;, &#39;Kuwait&#39;,
       &#39;Latin America &amp; Caribbean (excluding high income)&#39;, &#39;Lao PDR&#39;,
       &#39;Lebanon&#39;, &#39;Liberia&#39;, &#39;Libya&#39;, &#39;St. Lucia&#39;,
       &#39;Latin America &amp; Caribbean&#39;,
       &#39;Least developed countries: UN classification&#39;, &#39;Low income&#39;,
       &#39;Liechtenstein&#39;, &#39;Sri Lanka&#39;, &#39;Lower middle income&#39;,
       &#39;Low &amp; middle income&#39;, &#39;Lesotho&#39;, &#39;Late-demographic dividend&#39;,
       &#39;Lithuania&#39;, &#39;Luxembourg&#39;, &#39;Latvia&#39;, &#39;Macao SAR, China&#39;,
       &#39;St. Martin (French part)&#39;, &#39;Morocco&#39;, &#39;Monaco&#39;, &#39;Moldova&#39;,
       &#39;Madagascar&#39;, &#39;Maldives&#39;, &#39;Middle East &amp; North Africa&#39;, &#39;Mexico&#39;,
       &#39;Marshall Islands&#39;, &#39;Middle income&#39;, &#39;North Macedonia&#39;, &#39;Mali&#39;,
       &#39;Malta&#39;, &#39;Myanmar&#39;,
       &#39;Middle East &amp; North Africa (excluding high income)&#39;, &#39;Montenegro&#39;,
       &#39;Mongolia&#39;, &#39;Northern Mariana Islands&#39;, &#39;Mozambique&#39;, &#39;Mauritania&#39;,
       &#39;Mauritius&#39;, &#39;Malawi&#39;, &#39;Malaysia&#39;, &#39;North America&#39;, &#39;Namibia&#39;,
       &#39;New Caledonia&#39;, &#39;Niger&#39;, &#39;Nigeria&#39;, &#39;Nicaragua&#39;, &#39;Netherlands&#39;,
       &#39;Norway&#39;, &#39;Nepal&#39;, &#39;Nauru&#39;, &#39;New Zealand&#39;, &#39;OECD members&#39;, &#39;Oman&#39;,
       &#39;Other small states&#39;, &#39;Pakistan&#39;, &#39;Panama&#39;, &#39;Peru&#39;, &#39;Philippines&#39;,
       &#39;Palau&#39;, &#39;Papua New Guinea&#39;, &#39;Poland&#39;, &#39;Pre-demographic dividend&#39;,
       &#39;Puerto Rico&#39;, &quot;Korea, Dem. People&#39;s Rep.&quot;, &#39;Portugal&#39;, &#39;Paraguay&#39;,
       &#39;West Bank and Gaza&#39;, &#39;Pacific island small states&#39;,
       &#39;Post-demographic dividend&#39;, &#39;French Polynesia&#39;, &#39;Qatar&#39;,
       &#39;Romania&#39;, &#39;Russian Federation&#39;, &#39;Rwanda&#39;, &#39;South Asia&#39;,
       &#39;Saudi Arabia&#39;, &#39;Sudan&#39;, &#39;Senegal&#39;, &#39;Singapore&#39;, &#39;Solomon Islands&#39;,
       &#39;Sierra Leone&#39;, &#39;El Salvador&#39;, &#39;San Marino&#39;, &#39;Somalia&#39;, &#39;Serbia&#39;,
       &#39;Sub-Saharan Africa (excluding high income)&#39;, &#39;South Sudan&#39;,
       &#39;Sub-Saharan Africa&#39;, &#39;Small states&#39;, &#39;Sao Tome and Principe&#39;,
       &#39;Suriname&#39;, &#39;Slovak Republic&#39;, &#39;Slovenia&#39;, &#39;Sweden&#39;, &#39;Eswatini&#39;,
       &#39;Sint Maarten (Dutch part)&#39;, &#39;Seychelles&#39;, &#39;Syrian Arab Republic&#39;,
       &#39;Turks and Caicos Islands&#39;, &#39;Chad&#39;,
       &#39;East Asia &amp; Pacific (IDA &amp; IBRD countries)&#39;,
       &#39;Europe &amp; Central Asia (IDA &amp; IBRD countries)&#39;, &#39;Togo&#39;, &#39;Thailand&#39;,
       &#39;Tajikistan&#39;, &#39;Turkmenistan&#39;,
       &#39;Latin America &amp; the Caribbean (IDA &amp; IBRD countries)&#39;,
       &#39;Timor-Leste&#39;, &#39;Middle East &amp; North Africa (IDA &amp; IBRD countries)&#39;,
       &#39;Tonga&#39;, &#39;South Asia (IDA &amp; IBRD)&#39;,
       &#39;Sub-Saharan Africa (IDA &amp; IBRD countries)&#39;, &#39;Trinidad and Tobago&#39;,
       &#39;Tunisia&#39;, &#39;Turkiye&#39;, &#39;Tuvalu&#39;, &#39;Tanzania&#39;, &#39;Uganda&#39;, &#39;Ukraine&#39;,
       &#39;Upper middle income&#39;, &#39;Uruguay&#39;, &#39;United States&#39;, &#39;Uzbekistan&#39;,
       &#39;St. Vincent and the Grenadines&#39;, &#39;Venezuela, RB&#39;,
       &#39;British Virgin Islands&#39;, &#39;Virgin Islands (U.S.)&#39;, &#39;Vietnam&#39;,
       &#39;Vanuatu&#39;, &#39;World&#39;, &#39;Samoa&#39;, &#39;Kosovo&#39;, &#39;Yemen, Rep.&#39;,
       &#39;South Africa&#39;, &#39;Zambia&#39;, &#39;Zimbabwe&#39;], dtype=object)
</pre></div>
</div>
</div>
</details>
</div>
<ul class="simple">
<li><p>meltするために不要な列はdrop()で捨てる。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span> <span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Country Code&quot;</span><span class="p">,</span><span class="s2">&quot;Indicator Name&quot;</span><span class="p">,</span><span class="s2">&quot;Indicator Code&quot;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>id_varsを”Country Name”、 var_nameを’year’, value_nameを’fertility_rate’としてmeltする。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;Country Name&quot;</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;fertility_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>‘ ‘を欠損値に変換</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">melted_df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>型変換</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;fertility_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;fertility_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>やっとプロットできるが国が多すぎる。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">melted_df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;fertility_rate&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Country Name&quot;</span><span class="p">,</span><span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p>国を選んで可視化</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_countries</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Japan&#39;</span><span class="p">,</span><span class="s1">&#39;Korea, Rep.&#39;</span><span class="p">,</span><span class="s1">&#39;China&#39;</span><span class="p">,</span><span class="s1">&#39;Singapore&#39;</span><span class="p">]</span>
<span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">melted_df</span><span class="p">[</span><span class="n">melted_df</span><span class="p">[</span><span class="s2">&quot;Country Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selected_countries</span><span class="p">)],</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;fertility_rate&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Country Name&quot;</span><span class="p">,</span><span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#isinはグループへの包含を判定するpandasのメソッド</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<section id="chetty-2022">
<h4>Chetty(2022)のデータ<a class="headerlink" href="#chetty-2022" title="Link to this heading">#</a></h4>
<p>https://opportunityinsights.org/data/</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/berutaki/github.io/main/social_capital_county.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>county_name</th>
      <th>num_below_p50</th>
      <th>pop2018</th>
      <th>ec_county</th>
      <th>ec_se_county</th>
      <th>child_ec_county</th>
      <th>child_ec_se_county</th>
      <th>ec_grp_mem_county</th>
      <th>ec_high_county</th>
      <th>...</th>
      <th>child_exposure_county</th>
      <th>child_high_exposure_county</th>
      <th>bias_grp_mem_county</th>
      <th>bias_grp_mem_high_county</th>
      <th>child_bias_county</th>
      <th>child_high_bias_county</th>
      <th>clustering_county</th>
      <th>support_ratio_county</th>
      <th>volunteering_rate_county</th>
      <th>civic_organizations_county</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>Autauga, Alabama</td>
      <td>5922.3921</td>
      <td>55200.0</td>
      <td>0.72077</td>
      <td>0.00831</td>
      <td>1.11754</td>
      <td>0.02467</td>
      <td>0.77223</td>
      <td>1.21372</td>
      <td>...</td>
      <td>1.14816</td>
      <td>1.19944</td>
      <td>0.05526</td>
      <td>-0.22748</td>
      <td>0.02668</td>
      <td>-0.08229</td>
      <td>0.10347</td>
      <td>0.98275</td>
      <td>0.04355</td>
      <td>0.01518</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1003</td>
      <td>Baldwin, Alabama</td>
      <td>15458.3960</td>
      <td>208107.0</td>
      <td>0.74313</td>
      <td>0.00661</td>
      <td>0.83064</td>
      <td>0.01629</td>
      <td>0.76215</td>
      <td>1.28302</td>
      <td>...</td>
      <td>0.84588</td>
      <td>1.00797</td>
      <td>0.02950</td>
      <td>-0.21519</td>
      <td>0.01802</td>
      <td>-0.05241</td>
      <td>0.09624</td>
      <td>0.98684</td>
      <td>0.06117</td>
      <td>0.01526</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1005</td>
      <td>Barbour, Alabama</td>
      <td>4863.9736</td>
      <td>25782.0</td>
      <td>0.41366</td>
      <td>0.00978</td>
      <td>0.58541</td>
      <td>0.02707</td>
      <td>0.35927</td>
      <td>0.91897</td>
      <td>...</td>
      <td>0.63306</td>
      <td>0.71967</td>
      <td>0.13457</td>
      <td>-0.34086</td>
      <td>0.07528</td>
      <td>-0.19714</td>
      <td>0.14911</td>
      <td>0.99911</td>
      <td>0.02093</td>
      <td>0.01474</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1007</td>
      <td>Bibb, Alabama</td>
      <td>3061.4934</td>
      <td>22527.0</td>
      <td>0.63152</td>
      <td>0.01175</td>
      <td>0.72265</td>
      <td>0.03027</td>
      <td>0.68094</td>
      <td>1.06378</td>
      <td>...</td>
      <td>0.71433</td>
      <td>0.72395</td>
      <td>0.04108</td>
      <td>-0.27727</td>
      <td>-0.01165</td>
      <td>-0.15993</td>
      <td>0.14252</td>
      <td>0.99716</td>
      <td>0.05294</td>
      <td>0.01439</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1009</td>
      <td>Blount, Alabama</td>
      <td>6740.9116</td>
      <td>57645.0</td>
      <td>0.72562</td>
      <td>0.00985</td>
      <td>0.76096</td>
      <td>0.02466</td>
      <td>0.79584</td>
      <td>1.10569</td>
      <td>...</td>
      <td>0.74821</td>
      <td>0.79375</td>
      <td>0.00217</td>
      <td>-0.24946</td>
      <td>-0.01704</td>
      <td>-0.08745</td>
      <td>0.11243</td>
      <td>0.99069</td>
      <td>0.05704</td>
      <td>0.01724</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>3つの社会関係資本（ec_county, clustering_county, volunteering_rate_county）と貧困率との関係を散布図で示す。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;child_pov&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;num_below_p50&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop2018&#39;</span><span class="p">]</span><span class="c1">#中央値以下の貧困者の率</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;ec_county&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;child_pov&quot;</span><span class="p">)</span><span class="c1">#ec_countyは経済的な社会資本の指標</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;clustering_county&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;child_pov&quot;</span><span class="p">)</span><span class="c1">#clustering_countyは地域社会の結束力の指標</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;volunteering_rate_county&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;child_pov&quot;</span><span class="p">)</span><span class="c1">#volunteering_rate_countyはボランティア率</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;county_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="c1">#splitで,の前後[0 1]に分けた後、lambda関数で後ろ[1]だけとる。</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>州ごとに表示する。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;ec_county&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;child_pov&quot;</span><span class="p">,</span> <span class="n">facet_col</span> <span class="o">=</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">facet_col_wrap</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>
<section id="id35">
<h3>東京都の婚姻・離婚件数の時系列推移<a class="headerlink" href="#id35" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://www.hokeniryo.metro.tokyo.lg.jp/kiban/chosa_tokei/jinkodotaitokei/kushityosonbetsu.files/04koninrikon.csv&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp932&quot;</span><span class="p">)</span><span class="c1">#文字コードのエラーが出るので encoding = &quot;cp932&quot;を指定。</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>平成14年の婚姻件数</th>
      <th>平成15年の婚姻件数</th>
      <th>平成16年の婚姻件数</th>
      <th>平成17年の婚姻件数</th>
      <th>平成18年の婚姻件数</th>
      <th>平成19年の婚姻件数</th>
      <th>平成20年の婚姻件数</th>
      <th>平成21年の婚姻件数</th>
      <th>平成22年の婚姻件数</th>
      <th>...</th>
      <th>平成25年の離婚件数</th>
      <th>平成26年の離婚件数</th>
      <th>平成27年の離婚件数</th>
      <th>平成28年の離婚件数</th>
      <th>平成29年の離婚件数</th>
      <th>平成30年の離婚件数</th>
      <th>令和元年の離婚件数</th>
      <th>令和2年の離婚件数</th>
      <th>令和3年の離婚件数</th>
      <th>令和4年の離婚件数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>総数</td>
      <td>84623</td>
      <td>84755</td>
      <td>84618</td>
      <td>85382</td>
      <td>89413.0</td>
      <td>89243.0</td>
      <td>91196.0</td>
      <td>91028.0</td>
      <td>91197.0</td>
      <td>...</td>
      <td>24855</td>
      <td>23653</td>
      <td>24135</td>
      <td>23470</td>
      <td>23055</td>
      <td>22706</td>
      <td>22707</td>
      <td>20783</td>
      <td>19605</td>
      <td>19255</td>
    </tr>
    <tr>
      <th>1</th>
      <td>区部</td>
      <td>60265</td>
      <td>60358</td>
      <td>60812</td>
      <td>61898</td>
      <td>65569.0</td>
      <td>65689.0</td>
      <td>67418.0</td>
      <td>67607.0</td>
      <td>68036.0</td>
      <td>...</td>
      <td>17867</td>
      <td>16918</td>
      <td>17436</td>
      <td>16892</td>
      <td>16399</td>
      <td>16279</td>
      <td>16310</td>
      <td>14873</td>
      <td>13828</td>
      <td>13718</td>
    </tr>
    <tr>
      <th>2</th>
      <td>市部</td>
      <td>23933</td>
      <td>23958</td>
      <td>23419</td>
      <td>23107</td>
      <td>23444.0</td>
      <td>23159.0</td>
      <td>23400.0</td>
      <td>23049.0</td>
      <td>22773.0</td>
      <td>...</td>
      <td>6804</td>
      <td>6593</td>
      <td>6551</td>
      <td>6423</td>
      <td>6501</td>
      <td>6301</td>
      <td>6263</td>
      <td>5764</td>
      <td>5653</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>3</th>
      <td>郡部</td>
      <td>274</td>
      <td>281</td>
      <td>248</td>
      <td>247</td>
      <td>254.0</td>
      <td>273.0</td>
      <td>245.0</td>
      <td>242.0</td>
      <td>262.0</td>
      <td>...</td>
      <td>125</td>
      <td>81</td>
      <td>96</td>
      <td>88</td>
      <td>110</td>
      <td>82</td>
      <td>96</td>
      <td>88</td>
      <td>93</td>
      <td>94</td>
    </tr>
    <tr>
      <th>4</th>
      <td>島部</td>
      <td>151</td>
      <td>158</td>
      <td>139</td>
      <td>130</td>
      <td>146.0</td>
      <td>122.0</td>
      <td>133.0</td>
      <td>130.0</td>
      <td>126.0</td>
      <td>...</td>
      <td>59</td>
      <td>61</td>
      <td>52</td>
      <td>67</td>
      <td>45</td>
      <td>44</td>
      <td>38</td>
      <td>58</td>
      <td>31</td>
      <td>47</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 43 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>列名が元号かつ婚姻・離婚両方はいっているので、まず西暦にし、婚姻・離婚は変数名に残す。</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;区市町村&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:婚姻&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2023</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:離婚&#39;</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2023</span><span class="p">)]</span><span class="c1">#列変数名を変更</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>2002:婚姻</th>
      <th>2003:婚姻</th>
      <th>2004:婚姻</th>
      <th>2005:婚姻</th>
      <th>2006:婚姻</th>
      <th>2007:婚姻</th>
      <th>2008:婚姻</th>
      <th>2009:婚姻</th>
      <th>2010:婚姻</th>
      <th>...</th>
      <th>2013:離婚</th>
      <th>2014:離婚</th>
      <th>2015:離婚</th>
      <th>2016:離婚</th>
      <th>2017:離婚</th>
      <th>2018:離婚</th>
      <th>2019:離婚</th>
      <th>2020:離婚</th>
      <th>2021:離婚</th>
      <th>2022:離婚</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>総数</td>
      <td>84623</td>
      <td>84755</td>
      <td>84618</td>
      <td>85382</td>
      <td>89413.0</td>
      <td>89243.0</td>
      <td>91196.0</td>
      <td>91028.0</td>
      <td>91197.0</td>
      <td>...</td>
      <td>24855</td>
      <td>23653</td>
      <td>24135</td>
      <td>23470</td>
      <td>23055</td>
      <td>22706</td>
      <td>22707</td>
      <td>20783</td>
      <td>19605</td>
      <td>19255</td>
    </tr>
    <tr>
      <th>1</th>
      <td>区部</td>
      <td>60265</td>
      <td>60358</td>
      <td>60812</td>
      <td>61898</td>
      <td>65569.0</td>
      <td>65689.0</td>
      <td>67418.0</td>
      <td>67607.0</td>
      <td>68036.0</td>
      <td>...</td>
      <td>17867</td>
      <td>16918</td>
      <td>17436</td>
      <td>16892</td>
      <td>16399</td>
      <td>16279</td>
      <td>16310</td>
      <td>14873</td>
      <td>13828</td>
      <td>13718</td>
    </tr>
    <tr>
      <th>2</th>
      <td>市部</td>
      <td>23933</td>
      <td>23958</td>
      <td>23419</td>
      <td>23107</td>
      <td>23444.0</td>
      <td>23159.0</td>
      <td>23400.0</td>
      <td>23049.0</td>
      <td>22773.0</td>
      <td>...</td>
      <td>6804</td>
      <td>6593</td>
      <td>6551</td>
      <td>6423</td>
      <td>6501</td>
      <td>6301</td>
      <td>6263</td>
      <td>5764</td>
      <td>5653</td>
      <td>5396</td>
    </tr>
    <tr>
      <th>3</th>
      <td>郡部</td>
      <td>274</td>
      <td>281</td>
      <td>248</td>
      <td>247</td>
      <td>254.0</td>
      <td>273.0</td>
      <td>245.0</td>
      <td>242.0</td>
      <td>262.0</td>
      <td>...</td>
      <td>125</td>
      <td>81</td>
      <td>96</td>
      <td>88</td>
      <td>110</td>
      <td>82</td>
      <td>96</td>
      <td>88</td>
      <td>93</td>
      <td>94</td>
    </tr>
    <tr>
      <th>4</th>
      <td>島部</td>
      <td>151</td>
      <td>158</td>
      <td>139</td>
      <td>130</td>
      <td>146.0</td>
      <td>122.0</td>
      <td>133.0</td>
      <td>130.0</td>
      <td>126.0</td>
      <td>...</td>
      <td>59</td>
      <td>61</td>
      <td>52</td>
      <td>67</td>
      <td>45</td>
      <td>44</td>
      <td>38</td>
      <td>58</td>
      <td>31</td>
      <td>47</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>63</th>
      <td>御蔵島村</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>-</td>
      <td>4</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>64</th>
      <td>八丈町</td>
      <td>48</td>
      <td>44</td>
      <td>52</td>
      <td>46</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>41.0</td>
      <td>34.0</td>
      <td>25.0</td>
      <td>...</td>
      <td>18</td>
      <td>17</td>
      <td>20</td>
      <td>18</td>
      <td>14</td>
      <td>16</td>
      <td>15</td>
      <td>21</td>
      <td>10</td>
      <td>12</td>
    </tr>
    <tr>
      <th>65</th>
      <td>青ケ島村</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>66</th>
      <td>小笠原村</td>
      <td>25</td>
      <td>23</td>
      <td>25</td>
      <td>15</td>
      <td>27.0</td>
      <td>17.0</td>
      <td>21.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>9</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>7</td>
      <td>10</td>
    </tr>
    <tr>
      <th>67</th>
      <td>注 届出時の夫の住所により分類した。</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>68 rows × 43 columns</p>
</div></div></div>
</div>
<p>-冒頭の総数などと最終行の注意書きを削除</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>2002:婚姻</th>
      <th>2003:婚姻</th>
      <th>2004:婚姻</th>
      <th>2005:婚姻</th>
      <th>2006:婚姻</th>
      <th>2007:婚姻</th>
      <th>2008:婚姻</th>
      <th>2009:婚姻</th>
      <th>2010:婚姻</th>
      <th>...</th>
      <th>2013:離婚</th>
      <th>2014:離婚</th>
      <th>2015:離婚</th>
      <th>2016:離婚</th>
      <th>2017:離婚</th>
      <th>2018:離婚</th>
      <th>2019:離婚</th>
      <th>2020:離婚</th>
      <th>2021:離婚</th>
      <th>2022:離婚</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>千代田区</td>
      <td>235</td>
      <td>266</td>
      <td>294</td>
      <td>344</td>
      <td>398.0</td>
      <td>422.0</td>
      <td>464.0</td>
      <td>458.0</td>
      <td>465.0</td>
      <td>...</td>
      <td>88</td>
      <td>94</td>
      <td>117</td>
      <td>125</td>
      <td>119</td>
      <td>121</td>
      <td>134</td>
      <td>131</td>
      <td>109</td>
      <td>115</td>
    </tr>
    <tr>
      <th>6</th>
      <td>中央区</td>
      <td>729</td>
      <td>761</td>
      <td>949</td>
      <td>1114</td>
      <td>1292.0</td>
      <td>1277.0</td>
      <td>1403.0</td>
      <td>1411.0</td>
      <td>1522.0</td>
      <td>...</td>
      <td>323</td>
      <td>314</td>
      <td>320</td>
      <td>325</td>
      <td>379</td>
      <td>382</td>
      <td>377</td>
      <td>338</td>
      <td>329</td>
      <td>334</td>
    </tr>
    <tr>
      <th>7</th>
      <td>港区</td>
      <td>1425</td>
      <td>1533</td>
      <td>1576</td>
      <td>1724</td>
      <td>1929.0</td>
      <td>2094.0</td>
      <td>2110.0</td>
      <td>2172.0</td>
      <td>2264.0</td>
      <td>...</td>
      <td>585</td>
      <td>546</td>
      <td>651</td>
      <td>613</td>
      <td>573</td>
      <td>595</td>
      <td>559</td>
      <td>510</td>
      <td>491</td>
      <td>503</td>
    </tr>
    <tr>
      <th>8</th>
      <td>新宿区</td>
      <td>2159</td>
      <td>2207</td>
      <td>2284</td>
      <td>2382</td>
      <td>2459.0</td>
      <td>2473.0</td>
      <td>2642.0</td>
      <td>2679.0</td>
      <td>2735.0</td>
      <td>...</td>
      <td>675</td>
      <td>629</td>
      <td>590</td>
      <td>596</td>
      <td>579</td>
      <td>581</td>
      <td>572</td>
      <td>557</td>
      <td>484</td>
      <td>499</td>
    </tr>
    <tr>
      <th>9</th>
      <td>文京区</td>
      <td>1252</td>
      <td>1273</td>
      <td>1319</td>
      <td>1395</td>
      <td>1583.0</td>
      <td>1505.0</td>
      <td>1579.0</td>
      <td>1581.0</td>
      <td>1648.0</td>
      <td>...</td>
      <td>319</td>
      <td>303</td>
      <td>320</td>
      <td>315</td>
      <td>295</td>
      <td>291</td>
      <td>308</td>
      <td>276</td>
      <td>283</td>
      <td>272</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>62</th>
      <td>三宅村</td>
      <td>12</td>
      <td>8</td>
      <td>10</td>
      <td>14</td>
      <td>13.0</td>
      <td>17.0</td>
      <td>16.0</td>
      <td>21.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>9</td>
      <td>9</td>
      <td>8</td>
      <td>6</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>63</th>
      <td>御蔵島村</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>-</td>
      <td>4</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>64</th>
      <td>八丈町</td>
      <td>48</td>
      <td>44</td>
      <td>52</td>
      <td>46</td>
      <td>37.0</td>
      <td>35.0</td>
      <td>41.0</td>
      <td>34.0</td>
      <td>25.0</td>
      <td>...</td>
      <td>18</td>
      <td>17</td>
      <td>20</td>
      <td>18</td>
      <td>14</td>
      <td>16</td>
      <td>15</td>
      <td>21</td>
      <td>10</td>
      <td>12</td>
    </tr>
    <tr>
      <th>65</th>
      <td>青ケ島村</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>1</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
    </tr>
    <tr>
      <th>66</th>
      <td>小笠原村</td>
      <td>25</td>
      <td>23</td>
      <td>25</td>
      <td>15</td>
      <td>27.0</td>
      <td>17.0</td>
      <td>21.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>9</td>
      <td>5</td>
      <td>6</td>
      <td>3</td>
      <td>5</td>
      <td>7</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>62 rows × 43 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>“年”を変数とした縦持ちデータに変換</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;区市町村&quot;</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;年&quot;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;件数&quot;</span><span class="p">)</span>
<span class="n">melted_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>年</th>
      <th>件数</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>千代田区</td>
      <td>2002:婚姻</td>
      <td>235</td>
    </tr>
    <tr>
      <th>1</th>
      <td>中央区</td>
      <td>2002:婚姻</td>
      <td>729</td>
    </tr>
    <tr>
      <th>2</th>
      <td>港区</td>
      <td>2002:婚姻</td>
      <td>1425</td>
    </tr>
    <tr>
      <th>3</th>
      <td>新宿区</td>
      <td>2002:婚姻</td>
      <td>2159</td>
    </tr>
    <tr>
      <th>4</th>
      <td>文京区</td>
      <td>2002:婚姻</td>
      <td>1252</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2599</th>
      <td>三宅村</td>
      <td>2022:離婚</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2600</th>
      <td>御蔵島村</td>
      <td>2022:離婚</td>
      <td>-</td>
    </tr>
    <tr>
      <th>2601</th>
      <td>八丈町</td>
      <td>2022:離婚</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2602</th>
      <td>青ケ島村</td>
      <td>2022:離婚</td>
      <td>-</td>
    </tr>
    <tr>
      <th>2603</th>
      <td>小笠原村</td>
      <td>2022:離婚</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>2604 rows × 3 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>“年”変数から婚姻、離婚の値を取り出して新しく変数を作成する。</p></li>
<li><p>“年”変数自体もintに変換</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;婚姻・離婚&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;年&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
<span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;年&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">melted_df</span><span class="p">[</span><span class="s1">&#39;年&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>年</th>
      <th>件数</th>
      <th>婚姻・離婚</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>千代田区</td>
      <td>2002</td>
      <td>235</td>
      <td>婚姻</td>
    </tr>
    <tr>
      <th>1</th>
      <td>中央区</td>
      <td>2002</td>
      <td>729</td>
      <td>婚姻</td>
    </tr>
    <tr>
      <th>2</th>
      <td>港区</td>
      <td>2002</td>
      <td>1425</td>
      <td>婚姻</td>
    </tr>
    <tr>
      <th>3</th>
      <td>新宿区</td>
      <td>2002</td>
      <td>2159</td>
      <td>婚姻</td>
    </tr>
    <tr>
      <th>4</th>
      <td>文京区</td>
      <td>2002</td>
      <td>1252</td>
      <td>婚姻</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">melted_df</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;年&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;件数&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;区市町村&#39;</span><span class="p">,</span> <span class="n">line_dash</span> <span class="o">=</span> <span class="s1">&#39;婚姻・離婚&#39;</span><span class="p">,</span><span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#line_dashで婚姻と離婚を区別</span>
<span class="n">fig</span>
<span class="c1">#fig.update_yaxes(row=1, col=2, showticklabels=True)  # set the y-axis range and ticklabels for the second subplot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">melted_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;区市町村.str.contains(&quot;区&quot;)&#39;</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s1">&#39;python&#39;</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;年&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;件数&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;区市町村&#39;</span><span class="p">,</span> <span class="n">line_dash</span> <span class="o">=</span> <span class="s1">&#39;婚姻・離婚&#39;</span><span class="p">,</span><span class="n">markers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#区のみ取り出す</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<section id="id36">
<h4>問題<a class="headerlink" href="#id36" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>上のコードを参考に東京都の合計特殊出生率の時系列推移（[https://www.hokeniryo.metro.tokyo.lg.jp/kiban/chosa_tokei/jinkodotaitokei/kushityosonbetsu.files/04goukei.csv]）をプロットしてください。</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>区市町村</th>
      <th>平成5年</th>
      <th>平成6年</th>
      <th>平成7年</th>
      <th>平成8年</th>
      <th>平成9年</th>
      <th>平成10年</th>
      <th>平成11年</th>
      <th>平成12年</th>
      <th>平成13年</th>
      <th>...</th>
      <th>平成25年</th>
      <th>平成26年</th>
      <th>平成27年</th>
      <th>平成28年</th>
      <th>平成29年</th>
      <th>平成30年</th>
      <th>令和元年</th>
      <th>令和2年</th>
      <th>令和3年</th>
      <th>令和4年</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>総数</td>
      <td>1.1</td>
      <td>1.14</td>
      <td>1.11</td>
      <td>1.07</td>
      <td>1.05</td>
      <td>1.05</td>
      <td>1.03</td>
      <td>1.07</td>
      <td>1</td>
      <td>...</td>
      <td>1.13</td>
      <td>1.15</td>
      <td>1.24</td>
      <td>1.24</td>
      <td>1.21</td>
      <td>1.2</td>
      <td>1.15</td>
      <td>1.12</td>
      <td>1.08</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>区部</td>
      <td>1.06</td>
      <td>1.09</td>
      <td>1.02</td>
      <td>1.03</td>
      <td>1.01</td>
      <td>1</td>
      <td>0.98</td>
      <td>1</td>
      <td>0.97</td>
      <td>...</td>
      <td>1.16</td>
      <td>1.19</td>
      <td>1.22</td>
      <td>1.22</td>
      <td>1.2</td>
      <td>1.19</td>
      <td>1.13</td>
      <td>1.12</td>
      <td>1.09</td>
      <td>1.04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>市部</td>
      <td>1.27</td>
      <td>1.31</td>
      <td>1.23</td>
      <td>1.22</td>
      <td>1.2</td>
      <td>1.19</td>
      <td>1.16</td>
      <td>1.18</td>
      <td>1.14</td>
      <td>...</td>
      <td>1.27</td>
      <td>1.28</td>
      <td>1.32</td>
      <td>1.31</td>
      <td>1.28</td>
      <td>1.27</td>
      <td>1.23</td>
      <td>1.18</td>
      <td>1.15</td>
      <td>1.12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>郡部</td>
      <td>1.33</td>
      <td>1.32</td>
      <td>1.39</td>
      <td>1.34</td>
      <td>1.21</td>
      <td>1.32</td>
      <td>1.04</td>
      <td>1.23</td>
      <td>1.14</td>
      <td>...</td>
      <td>1.34</td>
      <td>1.34</td>
      <td>1.28</td>
      <td>1.45</td>
      <td>1.28</td>
      <td>1.32</td>
      <td>1.18</td>
      <td>1.1</td>
      <td>1.15</td>
      <td>1.03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>島部</td>
      <td>2.12</td>
      <td>1.75</td>
      <td>1.78</td>
      <td>1.67</td>
      <td>1.7</td>
      <td>1.67</td>
      <td>1.78</td>
      <td>1.74</td>
      <td>1.52</td>
      <td>...</td>
      <td>1.76</td>
      <td>1.61</td>
      <td>1.8</td>
      <td>1.69</td>
      <td>1.46</td>
      <td>1.63</td>
      <td>1.68</td>
      <td>1.66</td>
      <td>1.45</td>
      <td>1.26</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="id37">
<h4>問題<a class="headerlink" href="#id37" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>国勢調査の時系列データ[https://www.e-stat.go.jp/stat-search/file-download?statInfId=000031523105&amp;fileKind=1]を使って全年齢に関する人口の時系列推移をプロットしてください。</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>都道府県コード</th>
      <th>都道府県名</th>
      <th>年齢5歳階級</th>
      <th>元号</th>
      <th>和暦（年）</th>
      <th>西暦（年）</th>
      <th>人口（総数）</th>
      <th>人口（男）</th>
      <th>人口（女）</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01</td>
      <td>北海道</td>
      <td>総数</td>
      <td>大正</td>
      <td>9.0</td>
      <td>1920.0</td>
      <td>2359183.0</td>
      <td>1244322.0</td>
      <td>1114861.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>01</td>
      <td>北海道</td>
      <td>0～4歳</td>
      <td>大正</td>
      <td>9.0</td>
      <td>1920.0</td>
      <td>376676.0</td>
      <td>190044.0</td>
      <td>186632.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>01</td>
      <td>北海道</td>
      <td>5～9歳</td>
      <td>大正</td>
      <td>9.0</td>
      <td>1920.0</td>
      <td>319370.0</td>
      <td>161814.0</td>
      <td>157556.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01</td>
      <td>北海道</td>
      <td>10～14歳</td>
      <td>大正</td>
      <td>9.0</td>
      <td>1920.0</td>
      <td>270012.0</td>
      <td>138018.0</td>
      <td>131994.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01</td>
      <td>北海道</td>
      <td>15～19歳</td>
      <td>大正</td>
      <td>9.0</td>
      <td>1920.0</td>
      <td>239092.0</td>
      <td>125670.0</td>
      <td>113422.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">pandasについて</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">データフレームの構造</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">データの確認</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">データフレームの基本的操作</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">データ選択</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iloc-loc">iloc()とloc()</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">変数の追加、削除</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">変数の値のリコード</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">変数のソート</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">問題1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">問題1-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">問題1-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">問題1-3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">問題1-4</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#query">フィルタリング1(queryメソッド)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">フィルタリング2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#groupby">groupby（集団別操作）</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#applyagg">applyとagg</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">問題2</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">問題2-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">問題2-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">問題2-3</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">問題2-4:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">例題</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">問題2-5</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">データフレームの作成、列名の変更</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">インデックスの設定と解除</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">データフレームの結合</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">データフレームの結合（続き）</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">問題3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id27">例題</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id28">問題3-1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id29">問題3-2</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id30">問題3-3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotly">plotly入門</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id31">散布図</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id32">折れ線グラフ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id33">棒グラフ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tidy">tidyデータ</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melt">meltによる変換</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#go">goオブジェクト</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id34">世界銀行の出生率データ</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#chetty-2022">Chetty(2022)のデータ</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id35">東京都の婚姻・離婚件数の時系列推移</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id36">問題</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id37">問題</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 瀧川裕貴
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>